CHECK_ID,CHECK_TITLE,CHECK_SCORED,CHECK_CIS_LEVEL,CHECK_SEVERITY,CHECK_ASFF_RESOURCE_TYPE,CHECK_ALTERNATE,CHECK_ALTERNATE_check,CHECK_ASFF_COMPLIANCE_TYPE,CHECK_SERVICENAME,CHECK_RISK,CHECK_REMEDIATION,CHECK_DOC,CHECK_CAF_EPIC
7.110,[extra7110] Check if Amazon SageMaker Training job have VPC settings configured.,NOT_SCORED,EXTRA,Medium,AwsSageMakerNotebookInstance,extra7110,extra7110,NA,sagemaker,This could provide an avenue for unauthorized access to your data.,Restrict which traffic can access by launching Studio in a Virtual Private Cloud (VPC) of your choosing.,https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html,Infrastructure Security
7.117,[extra7117] Check if Glue data catalog settings have encrypt connection password enabled.,NOT_SCORED,EXTRA,Medium,AwsGlue,extra7117,extra7117,NA,glue,If not enabled sensitive information at rest is not protected.,On the AWS Glue console; you can enable this option on the Data catalog settings page.,https://docs.aws.amazon.com/glue/latest/dg/encrypt-connection-passwords.html,Data Protection
7.128,[extra7128] Check if DynamoDB table has encryption at rest enabled using CMK KMS,NOT_SCORED,EXTRA,Medium,AwsDynamoDBTable,extra7128,extra7128,ens-mp.info.3.aws.dyndb.1,dynamodb,All user data stored in Amazon DynamoDB is fully encrypted at rest. This functionality helps reduce the operational burden and complexity involved in protecting sensitive data.,Specify an encryption key when you create a new table or switch the encryption keys on an existing table by using the AWS Management Console.,https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html,Data Protection
7.121,[extra7121] Check if Glue development endpoints have Job bookmark encryption enabled.,NOT_SCORED,EXTRA,Medium,AwsGlue,extra7121,extra7121,NA,glue,If not enabled sensitive information at rest is not protected.,Enable Encryption in the Security configurations.,https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html,Data Protection
7.126,[extra7126] Check if there are CMK KMS keys not used,NOT_SCORED,EXTRA,Medium,AwsKmsKey,extra7126,extra7126,op.exp.11.aws.kms.2,kms,Unused keys may increase service cost.,Before deleting a customer master key (CMK); you might want to know how many cipher-texts were encrypted under that key.  ,https://docs.aws.amazon.com/kms/latest/developerguide/deleting-keys-determining-usage.html,Data Protection
7.119,[extra7119] Check if Glue development endpoints have CloudWatch logs encryption enabled.,NOT_SCORED,EXTRA,Medium,AwsGlue,extra7119,extra7119,NA,glue,If not enabled sensitive information at rest is not protected.,Enable Encryption in the Security configurations.,https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html,Logging and Monitoring
7.172,[extra7172] Check if S3 buckets have ACLs enabled,NOT_SCORED,EXTRA,Medium,AwsS3Bucket,extra7172,extra7172,NA,s3,S3 ACLs are a legacy access control mechanism that predates IAM. IAM and bucket policies are currently the preferred methods.,Ensure that S3 ACLs are disabled (BucketOwnerEnforced). Use IAM policies and bucket policies to manage access.,https://docs.aws.amazon.com/AmazonS3/latest/userguide/about-object-ownership.html,Logging and Monitoring
7.186,[extra7186] Check S3 Account Level Public Access Block,NOT_SCORED,EXTRA,High,AwsS3Bucket,extra7186,extra7186,NA,s3,Public access policies may be applied to sensitive data buckets,You can enable Public Access Block at the account level to prevent the exposure of your data stored in S3,https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html,Data Protection
3.7,[check37] Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created KMS CMKs,SCORED,LEVEL2,Medium,AwsCloudTrailTrail,check37,check37,ens-op.exp.11.aws.kms.1,kms,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.,It is recommended that a metric filter and alarm be established for unauthorized requests.,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,Logging and Monitoring
7.181,[extra7181] Directory Service monitoring with CloudWatch logs,NOT_SCORED,EXTRA,Medium,AwsDirectoryService,extra7181,NA,NA,ds,"As a best practice, monitor your organization to ensure that changes are logged. This helps you to ensure that any unexpected change can be investigated and unwanted changes can be rolled back.",It is recommended that that the export of logs is enabled,CHECK_DOC_extra7181='https://docs.aws.amazon.com/directoryservice/latest/admin-guide/incident-response.html',Infrastructure Security
7.175,[extra7175] CodeBuild Project with an user controlled buildspec,NOT_SCORED,EXTRA,High,NA,extra7175,extra7175,NA,codebuild,The CodeBuild projects with user controlled buildspec,Use buildspec.yml from a trusted source which user cant interfere with,https://docs.aws.amazon.com/codebuild/latest/userguide/security.html,Infrastructure Security
7.188,[extra7188] Ensure Radius server in DS is using the recommended security protocol,NOT_SCORED,EXTRA,Medium,AwsDirectoryService,extra7188,extra7188,NA,ds,"As a best practice, you might need to configure the authentication protocol between the Microsoft AD DCs and the RADIUS/MFA server. Supported protocols are PAP, CHAP MS-CHAPv1, and MS-CHAPv2. MS-CHAPv2 is recommended because it provides the strongest security of the three options.","MS-CHAPv2 provides the strongest security of the options supported, and is therefore recommended",https://aws.amazon.com/blogs/security/how-to-enable-multi-factor-authentication-for-amazon-workspaces-and-amazon-quicksight-by-using-microsoft-ad-and-on-premises-credentials/,Infrastructure Security
7.143,[extra7143] Check if EFS have policies which allow access to everyone,NOT_SCORED,EXTRA,Critical,AwsEFS,extra7143,extra7143,NA,efs,EFS accessible to everyone could expose sensitive data to bad actors,Ensure efs has some policy but it does not have principle as *,https://docs.aws.amazon.com/efs/latest/ug/access-control-block-public-access.html,Data Protection
7.144,[extra7144] Check if CloudWatch has allowed cross-account sharing,NOT_SCORED,EXTRA,Medium,AwsCloudWatch,extra7144,extra7144,NA,cloudwatch,Cross-Account access to CloudWatch could increase the risk of compromising information between accounts,Grant usage permission on a per-resource basis to enforce least privilege and Zero Trust principles,https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/Cross-Account-Cross-Region.html,Logging and Monitoring
3.9,[check39] Ensure a log metric filter and alarm exist for AWS Config configuration changes,SCORED,LEVEL2,Medium,AwsCloudTrailTrail,check39,check39,NA,configservice,If not enabled important changes to accounts could go unnoticed or difficult to find.,Use this service as a complement to implement detective controls that cannot be prevented. (e.g. a Security Group is modified to open to internet without restrictions or route changed to avoid going thru the network firewall). Ensure AWS Config is enabled in all regions in order to detect any not intended action. On the other hand if sufficient preventive controls to make changes in critical services are in place; the rating on this finding can be lowered or discarded depending on residual risk.,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,Logging and Monitoring
7.127,[extra7127] Check if EC2 instances managed by Systems Manager are compliant with patching requirements,NOT_SCORED,EXTRA,High,AwsEc2Instance,extra7127,extra7127,ens-op.exp.1.aws.sys.1 ens-op.exp.4.aws.sys.1,ssm,Without the most recent security patches your system is potentially vulnerable to cyberattacks. Even the best-designed software can not anticipate every future threat to cybersecurity. Poor patch management can leave an organizations data exposed subjecting them to malware and ransomware attacks.,Consider using SSM in all accounts and services to at least monitor for missing patches on servers. Use a robust process to apply security fixes as soon as they are made available. Patch compliance data from Patch Manager can be sent to AWS Security Hub to centralize security issues.,https://docs.aws.amazon.com/systems-manager/latest/userguide/patch-compliance-identify.html,Infrastructure Security
7.118,[extra7118] Check if Glue ETL Jobs have S3 encryption enabled.,NOT_SCORED,EXTRA,Medium,AwsGlue,extra7118,extra7118,NA,glue,If not enabled sensitive information at rest is not protected.,Provide the encryption properties that are used by crawlers; jobs; and development endpoints.,https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html,Data Protection
7.120,[extra7120] Check if Glue ETL Jobs have CloudWatch Logs encryption enabled.,NOT_SCORED,EXTRA,Medium,AwsGlue,extra7120,extra7120,NA,glue,If not enabled sensitive information at rest is not protected.,Enable Encryption in the Security configurations.,https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html,Logging and Monitoring
7.116,[extra7116] Check if Glue data catalog settings have metadata encryption enabled.,NOT_SCORED,EXTRA,Medium,AwsGlue,extra7116,extra7116,NA,glue,If not enabled sensitive information at rest is not protected.,Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits.,https://docs.aws.amazon.com/glue/latest/dg/encrypt-glue-data-catalog.html,Data Protection
7.129,[extra7129] Check if Application Load Balancer has a WAF ACL attached,NOT_SCORED,EXTRA,Medium,AwsElasticLoadBalancingV2LoadBalancer,extra7129,extra7129,ens-mp.s.2.aws.waf.3,elb,If not WAF ACL is attached risk of web attacks increases.,Using the AWS Management Console open the AWS WAF console to attach an ACL.,https://docs.aws.amazon.com/waf/latest/developerguide/web-acl-associating-aws-resource.html,Infrastructure Security
7.111,[extra7111] Check if Amazon SageMaker Notebook instances have direct internet access,NOT_SCORED,EXTRA,Medium,AwsSageMakerNotebookInstance,extra7111,extra7111,NA,sagemaker,This could provide an avenue for unauthorized access to your data.,Restrict which traffic can access by launching Studio in a Virtual Private Cloud (VPC) of your choosing.,https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html,Infrastructure Security
3.8,[check38] Ensure a log metric filter and alarm exist for S3 bucket policy changes,SCORED,LEVEL1,Medium,AwsCloudTrailTrail,check38,check38,NA,s3,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.,It is recommended that a metric filter and alarm be established for unauthorized requests.,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,Logging and Monitoring
7.145,[extra7145] Check if Lambda functions have policies which allow access to any AWS account,NOT_SCORED,EXTRA,Critical,AwsLambda,extra7145,extra7145,NA,lambda,Lambda function access to any AWS account may result security issues,Ensure Lambda function policiy does not allow access to any account,https://docs.aws.amazon.com/lambda/latest/dg/access-control-resource-based.html,IAM
7.189,[extra7189] Ensure Multi-Factor Authentication (MFA) using Radius Server is enabled in DS,NOT_SCORED,EXTRA,Medium,AwsDirectoryService,extra7189,extra7189,NA,ds,Multi-Factor Authentication (MFA) adds an extra layer of authentication assurance beyond traditional username and password.,Enabling MFA provides increased security to a user name and password as it requires the user to possess a solution that displays a time-sensitive authentication code.,https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_mfa.html,Infrastructure Security
7.142,[extra7142] Check if Application Load Balancer is dropping invalid packets to prevent header based HTTP request smuggling,NOT_SCORED,EXTRA,Medium,AwsElasticLoadBalancingV2LoadBalancer,extra7142,extra7142,,elb,ALB can be target of actors sending bad HTTP headers,Ensure Application Load Balancer is configured for HTTP headers with header fields that are not valid are removed by the load balancer (true),https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancers.html#desync-mitigation-mode,Data Protection
3.6,[check36] Ensure a log metric filter and alarm exist for AWS Management Console authentication failures,SCORED,LEVEL2,Medium,AwsCloudTrailTrail,check36,check36,ens-op.exp.8.aws.trail.3,iam,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.,It is recommended that a metric filter and alarm be established for unauthorized requests.,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,Logging and Monitoring
7.174,[extra7174] CodeBuild Project last invoked greater than 90 days,NOT_SCORED,EXTRA,High,NA,extra7174,extra7174,NA,codebuild,Older CodeBuild projects can be checked to see if they are currently in use,Check if CodeBuild project are really in use and remove the stale ones,https://docs.aws.amazon.com/codebuild/latest/userguide/delete-project.html,Infrastructure Security
7.180,[extra7180] Check Lambda Function URL CORS configuration,NOT_SCORED,EXTRA,Medium,AwsLambdaFunction,extra7180,extra7180,NA,lambda,Publicly accessible services could expose sensitive data to bad actors.,Grant usage permission on a per-resource basis and applying least privilege principle.,https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html,Infrastructure Security
3.1,[check31] Ensure a log metric filter and alarm exist for unauthorized API calls,SCORED,LEVEL1,Medium,AwsCloudTrailTrail,check31,check31,ens-op.exp.8.aws.trail.2,iam,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.,It is recommended that a metric filter and alarm be established for unauthorized requests.,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,Logging and Monitoring
7.187,[extra7187] Ensure that your Amazon WorkSpaces storage volumes are encrypted in order to meet security and compliance requirements,NOT_SCORED,EXTRA,High,AwsWorkspaces,extra7187,extra7187,NA,workspaces,If the value listed in the Volume Encryption column is Disabled the selected AWS WorkSpaces instance volumes (root and user volumes) are not encrypted. Therefore your data-at-rest is not protected from unauthorized access and does not meet the compliance requirements regarding data encryption.,WorkSpaces is integrated with the AWS Key Management Service (AWS KMS). This enables you to encrypt storage volumes of WorkSpaces using AWS KMS Key. When you launch a WorkSpace you can encrypt the root volume (for Microsoft Windows - the C drive; for Linux - /) and the user volume (for Windows - the D drive; for Linux - /home). Doing so ensures that the data stored at rest - disk I/O to the volume - and snapshots created from the volumes are all encrypted,https://docs.aws.amazon.com/workspaces/latest/adminguide/encrypt-workspaces.html,Infrastructure Security
7.173,[extra7173] Security Groups created by EC2 Launch Wizard,NOT_SCORED,EXTRA,Medium,AwsEc2SecurityGroup,extra7173,extra7173,NA,ec2,Security Groups Created on the AWS Console using the EC2 wizard may allow port 22 from 0.0.0.0/0,Apply Zero Trust approach. Implement a process to scan and remediate security groups created by the EC2 Wizard. Recommended best practices is to use an authorized security group.,CHECK_DOC_extra7173='https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html',Infrastructure Security
7.23,[extra723] Check if RDS Snapshots and Cluster Snapshots are public,NOT_SCORED,EXTRA,Critical,AwsRdsDbSnapshot,extra723,extra723,NA,rds,Publicly accessible services could expose sensitive data to bad actors. t is recommended that your RDS snapshots should not be public in order to prevent potential leak or misuse of sensitive data or any other kind of security threat. If your RDS snapshot is public; then the data which is backed up in that snapshot is accessible to all other AWS accounts.,Use AWS Config to identify any sanpshot that is public.,https://docs.aws.amazon.com/config/latest/developerguide/rds-snapshots-public-prohibited.html,Data Protection
7.6,[extra76] Ensure there are no EC2 AMIs set as Public,NOT_SCORED,EXTRA,Critical,NA,extra76,extra76,NA,ec2,A shared AMI is an AMI that a developer created and made available for other developers to use. If AMIs have embebed information about the environment could pose a security risk. You use a shared AMI at your own risk. Amazon can not vouch for the integrity or security of AMIs shared by Amazon EC2 users. ,List all shared AMIs and make sure there is a business reason for them.,https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/usingsharedamis-finding.html,Infrastructure Security
7.24,[extra724] Check if ACM certificates have Certificate Transparency logging enabled,NOT_SCORED,EXTRA,Medium,AwsCertificateManagerCertificate,extra724,extra724,NA,acm,Domain owners can search the log to identify unexpected certificates; whether issued by mistake or malice. Domain owners can also identify Certificate Authorities (CAs) that are improperly issuing certificates.,Make sure you are logging information about Lambda operations. Create a lifecycle and use cases for each trail.,https://aws.amazon.com/blogs/security/how-to-get-ready-for-certificate-transparency/,Logging and Monitoring
7.1,[extra71] Ensure users of groups with AdministratorAccess policy have MFA tokens enabled,NOT_SCORED,EXTRA,High,AwsIamUser,extra71,extra71,ens-op.exp.10.aws.trail.2,iam,"Policy ""may"" allow Anonymous users to perform actions.",Ensure this repository and its contents should be publicly accessible.,https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable_virtual.html,Infrastructure Security
7.8,[extra78] Ensure there are no Public Accessible RDS instances,NOT_SCORED,EXTRA,Critical,AwsRdsDbInstance,extra78,extra78,NA,rds,Publicly accessible databases could expose sensitive data to bad actors.,Using an AWS Config rule check for RDS public instances periodically and check there is a business reason for it.,https://docs.amazonaws.cn/en_us/config/latest/developerguide/rds-instance-public-access-check.html,Data Protection
7.12,[extra712] Check if Amazon Macie is enabled,NOT_SCORED,EXTRA,Low,AwsMacieSession,extra712,extra712,NA,macie,Amazon Macie is a fully managed data security and data privacy service that uses machine learning and pattern matching to help you discover; monitor; and protect your sensitive data in AWS.,Enable Amazon Macie and create appropriate jobs to discover sensitive data.,https://docs.aws.amazon.com/macie/latest/user/getting-started.html,Data Protection
7.15,[extra715] Check if Amazon Elasticsearch Service (ES) domains have logging enabled,NOT_SCORED,EXTRA,Medium,AwsElasticsearchDomain,extra715,extra715,NA,es,Amazon ES exposes four Elasticsearch logs through Amazon CloudWatch Logs: error logs; search slow logs; index slow logs; and audit logs. ,Enable Elasticsearch log. Create use cases for them. Using audit logs check for access denied events.,https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-createdomain-configure-slow-logs.html,Logging and Monitoring
3.12,[check312] Ensure a log metric filter and alarm exist for changes to network gateways,SCORED,LEVEL1,Medium,AwsCloudTrailTrail,check312,check312,NA,vpc,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.,It is recommended that a metric filter and alarm be established for unauthorized requests.,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,Logging and Monitoring
1.20,[check120] Ensure a support role has been created to manage incidents with AWS Support,SCORED,LEVEL1,Medium,AwsIamRole,check120,check120,ens-op.acc.1.aws.iam.4,iam,AWS provides a support center that can be used for incident notification and response; as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.,Create an IAM role for managing incidents with AWS.,https://docs.aws.amazon.com/awssupport/latest/user/accessing-support.html,IAM
7.41,[extra741] Find secrets in EC2 User Data,NOT_SCORED,EXTRA,Critical,AwsEc2Instance,extra741,extra741,NA,ec2,Secrets hardcoded into instance user data can be used by malware and bad actors to gain lateral access to other services.,Implement automated detective control (e.g. using tools like Prowler ) to scan accounts for passwords and secrets. Use secrets manager service to store and retrieve passwords and secrets. ,https://docs.aws.amazon.com/secretsmanager/latest/userguide/tutorials_basic.html,IAM
7.79,[extra779] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Elasticsearch/Kibana ports,NOT_SCORED,EXTRA,High,AwsEc2SecurityGroup,extra779,extra779,NA,ec2,If Security groups are not properly configured the attack surface is increased. ,Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.,https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html,Infrastructure Security
7.46,[extra746] Check if API Gateway has configured authorizers,NOT_SCORED,EXTRA,Medium,AwsApiGatewayRestApi,extra746,extra746,NA,apigateway,If no authorizer is enabled anyone can use the service.,Implement Amazon Cognito or a Lambda function to control access to your API.,https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-use-lambda-authorizer.html,IAM
1.18,[check118] Ensure security contact information is registered,SCORED,LEVEL1,Medium,NA,check118,check118,NA,support,AWS provides customers with the option of specifying the contact information for accounts security team. It is recommended that this information be provided. Specifying security-specific contact information will help ensure that security advisories sent by AWS reach the team in your organization that is best equipped to respond to them.,Go to the My Account section and complete alternate contacts.,https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/manage-account-payment.html,IAM
1.11,[check111] Ensure IAM password policy expires passwords within 90 days or less,SCORED,LEVEL1,Medium,NA,check111,check111,NA,iam,Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.,"Ensure ""Password expiration period (in days):"" is set to 90 or less.",https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html,IAM
7.84,[extra784] Check if Amazon Elasticsearch Service (ES) domains internal user database enabled,NOT_SCORED,EXTRA,Medium,AwsElasticsearchDomain,extra784,extra784,NA,es,Internal User Database is convenient for demos; for production environment use Federated authentication.,Remove users from internal user database and uso Cognito instead.,https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/fgac.html,IAM
7.70,[extra770] Check for internet facing EC2 instances with Instance Profiles attached ,NOT_SCORED,EXTRA,Medium,AwsEc2Instance,extra770,extra770,NA,ec2,Exposing an EC2 directly to internet increases the attack surface and therefore the risk of compromise.,Use an ALB and apply WAF ACL.,https://aws.amazon.com/blogs/aws/aws-web-application-firewall-waf-for-application-load-balancers/,Infrastructure Security
1.16,[check116] Ensure IAM policies are attached only to groups or roles,SCORED,LEVEL1,Low,AwsIamUser,check116,check116,ens-op.acc.3.aws.iam.1,iam,By default IAM users; groups; and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users; groups; or roles. It is recommended that IAM policies be applied directly to groups and roles but not users. Assigning privileges at the group or role level reduces the complexity of access management as the number of users grow. Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.,Remove any policy attached directly to the user. Use groups or roles instead.,https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html,IAM
7.48,[extra748] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to any port,NOT_SCORED,EXTRA,High,AwsEc2SecurityGroup,extra748,extra748,NA,ec2,If Security groups are not properly configured the attack surface is increased. ,Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.,https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html,Infrastructure Security
7.77,[extra777] Find VPC security groups with more than 50 ingress or egress rules ,NOT_SCORED,EXTRA,Medium,AwsEc2SecurityGroup,extra777,extra777,NA,ec2,If Security groups are not properly configured the attack surface is increased. ,Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.,https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html,Infrastructure Security
7.83,[extra783] Check if Amazon Elasticsearch Service (ES) domains has enforce HTTPS enabled,NOT_SCORED,EXTRA,Medium,AwsElasticsearchDomain,extra783,extra783,NA,es,If not enable unauthorized access to your data could risk increases.,"When creating ES Domains; enable ""Require HTTPS fo all traffic to the domain"".",https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-createupdatedomains.html,Data Protection
7.14,[extra714] Check if CloudFront distributions have logging enabled,NOT_SCORED,EXTRA,Medium,AwsCloudFrontDistribution,extra714,extra714,NA,cloudfront,If not enabled monitoring of service use is not possible.,Real-time monitoring can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Enable logging for services with defined log rotation. This logs are useful for Incident Response and forensics investigation among other use cases.,https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/AccessLogs.html,Logging and Monitoring
7.13,[extra713] Check if GuardDuty is enabled,NOT_SCORED,EXTRA,High,AwsGuardDutyDetector,extra713,extra713,ens-op.mon.1.aws.duty.1,guardduty,Amazon GuardDuty is a continuous security monitoring service that analyzes and processes several datasources.,Enable GuardDuty and analyze its findings.,https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_settingup.html,Data Protection
7.9,[extra79] Check for internet facing Elastic Load Balancers,NOT_SCORED,EXTRA,Medium,AwsElbLoadBalancer,extra79,extra79,NA,elb,Publicly accessible load balancers could expose sensitive data to bad actors.,Ensure the load balancer should be publicly accessible. If publicly exposed ensure a WAF ACL is implemented.,https://docs.aws.amazon.com/waf/latest/developerguide/web-acl-associating-aws-resource.html,Data Protection
NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA
7.25,[extra725] Check if S3 buckets have Object-level logging enabled in CloudTrail,NOT_SCORED,EXTRA,Medium,AwsS3Bucket,extra725,extra725,NA,s3,If logs are not enabled; monitoring of service use and threat analysis is not possible.,Enable logs. Create an S3 lifecycle policy. Define use cases; metrics and automated responses where applicable.,https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-cloudtrail-logging-for-s3.html,Logging and Monitoring
7.22,[extra722] Check if API Gateway has logging enabled,NOT_SCORED,EXTRA,Medium,AwsApiGatewayRestApi,extra722,extra722,NA,apigateway,If not enabled; monitoring of service use is not possible. Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms.,Monitoring is an important part of maintaining the reliability; availability; and performance of API Gateway and your AWS solutions. You should collect monitoring data from all of the parts of your AWS solution. CloudTrail provides a record of actions taken by a user; role; or an AWS service in API Gateway. Using the information collected by CloudTrail; you can determine the request that was made to API Gateway; the IP address from which the request was made; who made the request; etc.,https://docs.aws.amazon.com/apigateway/latest/developerguide/security-monitoring.html,Logging and Monitoring
7.7,[extra77] Ensure there are no ECR repositories set as Public,NOT_SCORED,EXTRA,Critical,NA,extra77,extra77,NA,ecr,Policy may allow Anonymous users to perform actions.,Ensure this repository and its contents should be publicly accessible.,https://docs.aws.amazon.com/AmazonECR/latest/public/security_iam_service-with-iam.html,Data Protection
9.9999,[check9999] Custom Defined Check,NOT_SCORED,EXTRA,Critical,Custom,extra9999,NA,NA,custom,Custom Defined Risk,Custom Remediation,NA,Custom EPIC
1.17,[check117] Maintain current contact details,SCORED,LEVEL1,Medium,NA,check117,check117,NA,support,Ensure contact email and telephone details for AWS accounts are current and map to more than one individual in your organization. An AWS account supports a number of contact details; and AWS will use these to contact the account owner if activity judged to be in breach of Acceptable Use Policy. If an AWS account is observed to be behaving in a prohibited or suspicious manner; AWS will attempt to contact the account owner by email and phone using the contact details listed. If this is unsuccessful and the account behavior needs urgent mitigation; proactive measures may be taken; including throttling of traffic between the account exhibiting suspicious behavior and the AWS API endpoints and the Internet. This will result in impaired service to and from the account in question.,Using the Billing and Cost Management console complete contact details.,https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/manage-account-payment.html#contact-info,IAM
7.49,[extra749] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Oracle ports 1521 or 2483,NOT_SCORED,EXTRA,High,AwsEc2SecurityGroup,extra749,extra749,ens-mp.com.4.aws.sg.6,ec2,If Security groups are not properly configured the attack surface is increased. ,Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.,https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html,Infrastructure Security
7.82,[extra782] Check if Amazon Elasticsearch Service (ES) domains has node-to-node encryption enabled,NOT_SCORED,EXTRA,Medium,AwsElasticsearchDomain,extra782,extra782,NA,es,Node-to-node encryption provides an additional layer of security on top of the default features of Amazon ES. This architecture prevents potential attackers from intercepting traffic between Elasticsearch nodes and keeps the cluster secure.,Node-to-node encryption on new domains requires Elasticsearch 6.0 or later. Enabling the feature on existing domains requires Elasticsearch 6.7 or later. Choose the existing domain in the AWS console; Actions; and Modify encryption.,https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/ntn.html,Data Protection
7.76,[extra776] Check if ECR image scan found vulnerabilities in the newest image version,NOT_SCORED,EXTRA,Medium,AwsEcrRepository,extra776,extra776,NA,ecr,Amazon ECR image scanning helps in identifying software vulnerabilities in your container images. Amazon ECR uses the Common Vulnerabilities and Exposures (CVEs) database from the open-source Clair project and provides a list of scan findings. ,Open the Amazon ECR console. Then look for vulnerabilities and fix them.,https://docs.aws.amazon.com/AmazonECR/latest/userguide/image-scanning.html#describe-scan-findings,Logging and Monitoring
1.10,[check110] Ensure IAM password policy prevents password reuse: 24 or greater,SCORED,LEVEL1,Medium,NA,check110,check110,NA,iam,Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.,"Ensure ""Number of passwords to remember"" is set to 24.",https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html,IAM
7.71,[extra771] Check if S3 buckets have policies which allow WRITE access ,NOT_SCORED,EXTRA,Critical,AwsS3Bucket,extra771,extra771,NA,s3,Non intended users can put objects in a given bucket.,Ensure proper bucket policy is in place with the least privilege principle applied.,https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_examples_s3_rw-bucket.html,IAM
7.85,[extra785] Check if Amazon Elasticsearch Service (ES) domains have updates available,NOT_SCORED,EXTRA,Low,AwsElasticsearchDomain,extra785,extra785,NA,es,Amazon ES regularly releases system software updates that add features or otherwise improve your domains.,The Notifications panel in the console is the easiest way to see if an update is available or check the status of an update. You can also receive these notifications through Amazon EventBridge. If you take no action on required updates; Amazon ES still updates your domain service software automatically after a certain timeframe (typically two weeks). In this situation; Amazon ES sends notifications when it starts the update and when the update is complete.,https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-service-software.html,Infrastructure Security
3.14,[check314] Ensure a log metric filter and alarm exist for VPC changes,SCORED,LEVEL1,Medium,AwsCloudTrailTrail,check314,check314,NA,vpc,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.,It is recommended that a metric filter and alarm be established for unauthorized requests.,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,Logging and Monitoring
7.78,[extra778] Find VPC security groups with wide-open public IPv4 CIDR ranges (non-RFC1918) ,NOT_SCORED,EXTRA,Medium,AwsEc2SecurityGroup,extra778,extra778,NA,ec2,If Security groups are not properly configured the attack surface is increased. ,Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.,https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html,Infrastructure Security
7.47,[extra747] Check if RDS instances is integrated with CloudWatch Logs,NOT_SCORED,EXTRA,Medium,AwsRdsDbInstance,extra747,extra747,NA,rds,If logs are not enabled; monitoring of service use and threat analysis is not possible.,Use CloudWatch Logs to perform real-time analysis of the log data. Create alarms and view metrics.,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/publishing_cloudwatchlogs.html,Logging and Monitoring
1.19,[check119] Ensure IAM instance roles are used for AWS resource access from instances,NOT_SCORED,LEVEL2,Medium,AwsEc2Instance,check119,check119,NA,ec2,AWS access from within AWS instances can be done by either encoding AWS keys into AWS API calls or by assigning the instance to a role which has an appropriate permissions policy for the required access. AWS IAM roles reduce the risks associated with sharing and rotating credentials that can be used outside of AWS itself. If credentials are compromised; they can be used from outside of the AWS account.,Create an IAM instance role if necessary and attach it to the corresponding EC2 instance.,http://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-ec2.html,IAM
1.21,[check121] Do not setup access keys during initial user setup for all IAM users that have a console password,NOT_SCORED,LEVEL1,Medium,AwsIamUser,check121,check121,ens-op.acc.1.aws.iam.5,iam,AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials; it also generates unnecessary management work in auditing and rotating these keys. Requiring that additional steps be taken by the user after their profile has been created will give a stronger indication of intent that access keys are (a) necessary for their work and (b) once the access key is established on an account that the keys may be in use somewhere in the organization.,From the IAM console: generate credential report and disable not required keys.,https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_getting-report.html,IAM
3.13,[check313] Ensure a log metric filter and alarm exist for route table changes,SCORED,LEVEL1,Medium,AwsCloudTrailTrail,check313,check313,NA,vpc,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.,It is recommended that a metric filter and alarm be established for unauthorized requests.,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,Logging and Monitoring
7.40,[extra740] Check if EBS snapshots are encrypted,NOT_SCORED,EXTRA,Medium,AwsEc2Snapshot,extra740,extra740,ens-mp.info.3.aws.ebs.3,ec2,Data encryption at rest prevents data visibility in the event of its unauthorized access or theft.,Encrypt all EBS Snapshot and Enable Encryption by default. You can configure your AWS account to enforce the encryption of the new EBS volumes and snapshot copies that you create. For example; Amazon EBS encrypts the EBS volumes created when you launch an instance and the snapshots that you copy from an unencrypted snapshot.,https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html#encryption-by-default,Data Protection
7.96,[extra796] Restrict Access to the EKS Control Plane Endpoint,NOT_SCORED,EXTRA,High,AwsEksCluster,extra796,extra796,NA,eks,By default; this API server endpoint is public to the internet; and access to the API server is secured using a combination of AWS Identity and Access Management (IAM) and native Kubernetes Role Based Access Control (RBAC).,You should enable private access to the Kubernetes API server so that all communication between your nodes and the API server stays within your VPC. You can limit the IP addresses that can access your API server from the internet; or completely disable internet access to the API server.,https://docs.aws.amazon.com/eks/latest/userguide/cluster-endpoint.html,Infrastructure Security
7.62,[extra762] Find obsolete Lambda runtimes ,NOT_SCORED,EXTRA,Medium,AwsLambdaFunction,extra762,extra762,NA,lambda,If you have functions running on a runtime that will be deprecated in the next 60 days; Lambda notifies you by email that you should prepare by migrating your function to a supported runtime. In some cases; such as security issues that require a backwards-incompatible update; or software that does not support a long-term support (LTS) schedule; advance notice might not be possible. After a runtime is deprecated; Lambda might retire it completely at any time by disabling invocation. Deprecated runtimes are not eligible for security updates or technical support.,Test new runtimes as they are made available. Implement them in production as soon as possible.,https://docs.aws.amazon.com/lambda/latest/dg/runtime-support-policy.html,Infrastructure Security
7.65,[extra765] Check if ECR image scan on push is enabled ,NOT_SCORED,EXTRA,Medium,NA,extra765,extra765,NA,ecr,Amazon ECR image scanning helps in identifying software vulnerabilities in your container images. Amazon ECR uses the Common Vulnerabilities and Exposures (CVEs) database from the open-source Clair project and provides a list of scan findings. ,Enable ECR image scanning and review the scan findings for information about the security of the container images that are being deployed.,https://docs.aws.amazon.com/AmazonECR/latest/userguide/image-scanning.html,Infrastructure Security
7.91,[extra791] Check if CloudFront distributions are using deprecated SSL protocols,NOT_SCORED,EXTRA,Medium,AwsCloudFrontDistribution,extra791,extra791,NA,cloudfront,Using insecure ciphers could affect privacy of in transit information.,Use a Security policy with a ciphers that are stronger as possible. Drop legacy and unsecure ciphers.,https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/secure-connections-supported-viewer-protocols-ciphers.html,Data Protection
7.53,[extra753] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MongoDB ports 27017 and 27018,NOT_SCORED,EXTRA,High,AwsEc2SecurityGroup,extra753,extra753,ens-mp.com.4.aws.sg.10,ec2,If Security groups are not properly configured the attack surface is increased. ,Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.,https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html,Infrastructure Security
7.98,[extra798] Check if Lambda functions have resource-based policy set as Public,NOT_SCORED,EXTRA,Critical,AwsLambdaFunction,extra798,extra798,NA,lambda,Publicly accessible services could expose sensitive data to bad actors.,Grant usage permission on a per-resource basis and applying least privilege principle.,https://docs.aws.amazon.com/lambda/latest/dg/access-control-resource-based.html,Infrastructure Security
7.54,[extra754] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Cassandra ports 7199 or 9160 or 8888,NOT_SCORED,EXTRA,High,AwsEc2SecurityGroup,extra754,extra754,ens-mp.com.4.aws.sg.11,ec2,If Security groups are not properly configured the attack surface is increased. ,Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.,https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html,Infrastructure Security
7.38,[extra738] Check if CloudFront distributions are set to HTTPS,NOT_SCORED,EXTRA,Medium,AwsCloudFrontDistribution,extra738,extra738,ens-mp.com.2.aws.front.1,cloudfront,If not enabled sensitive information in transit is not protected. Surveillance and other threats are risks may exists.,Use HTTPS everywhere possible. It will enforce privacy and protect against account hijacking and other threats.,https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/using-https.html,Data Protection
7.31,[extra731] Check if SNS topics have policy set as Public,NOT_SCORED,EXTRA,Critical,AwsSnsTopic,extra731,extra731,NA,sns,Publicly accessible services could expose sensitive data to bad actors.,Ensure there is a business requirement for service to be public.,https://docs.aws.amazon.com/config/latest/developerguide/sns-topic-policy.html,Infrastructure Security
7.36,[extra736] Check exposed KMS keys,NOT_SCORED,EXTRA,Critical,AwsKmsKey,extra736,extra736,ens-op.exp.11.aws.kms.2,kms,Exposed KMS Keys or wide policy permissions my leave data unprotected.,To determine the full extent of who or what currently has access to a customer master key (CMK) in AWS KMS; you must examine the CMK key policy; all grants that apply to the CMK; and potentially all AWS Identity and Access Management (IAM) policies. You might do this to determine the scope of potential usage of a CMK.,https://docs.aws.amazon.com/kms/latest/developerguide/determining-access.html,Data Protection
7.55,[extra755] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Memcached port 11211,NOT_SCORED,EXTRA,High,AwsEc2SecurityGroup,extra755,extra755,ens-mp.com.4.aws.sg.12,ec2,If Security groups are not properly configured the attack surface is increased. ,Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.,https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html,Infrastructure Security
7.52,[extra752] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Redis port 6379,NOT_SCORED,EXTRA,High,AwsEc2SecurityGroup,extra752,extra752,ens-mp.com.4.aws.sg.9,ec2,If Security groups are not properly configured the attack surface is increased. ,Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.,https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html,Infrastructure Security
7.99,[extra799] Check if Security Hub is enabled and its standard subscriptions,NOT_SCORED,EXTRA,High,AwsSecurityHubHub,extra799,extra799,NA,securityhub,AWS Security Hub gives you a comprehensive view of your security alerts and security posture across your AWS accounts.,Security Hub is Regional. When you enable or disable a security standard; it is enabled or disabled only in the current Region or in the Region that you specify.,https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-enable-disable.html,Logging and Monitoring
7.90,[extra790] Find trust boundaries in VPC endpoint services allowlisted principles,NOT_SCORED,EXTRA,Medium,AwsEc2Vpc,extra790,NA,NA,vpc,Account VPC could be linked to other accounts.,In multi Account environments identify untrusted links. Check trust chaining and dependencies between accounts.,https://github.com/toniblyx/prowler/#trust-boundaries-checks,Infrastructure Security
7.64,[extra764] Check if S3 buckets have secure transport policy ,NOT_SCORED,EXTRA,Medium,AwsS3Bucket,extra764,extra764,ens-mp.com.2.aws.s3.1,s3,If HTTPS is not enforced on the bucket policy; communication between clients and S3 buckets can use unencrypted HTTP. As a result; sensitive information could be transmitted in clear text over the network or internet.,Ensure that S3 buckets has encryption in transit enabled.,https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html,Data Protection
7.63,[extra763] Check if S3 buckets have object versioning enabled ,NOT_SCORED,EXTRA,Medium,AwsS3Bucket,extra763,extra763,NA,s3, With versioning; you can easily recover from both unintended user actions and application failures.,Configure versioning using the Amazon console or API for buckets with sensitive information that is changing frecuently; and backup may not be enough to capture all the changes.,https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/Versioning.html,Data Protection
7.97,[extra797] Ensure Kubernetes Secrets are encrypted using Customer Master Keys (CMKs),NOT_SCORED,EXTRA,Medium,AwsEksCluster,extra797,extra797,NA,eks,Implementing envelope encryption is considered a security best practice for applications that store sensitive data and is part of a defense in depth security strategy., Setup your own Customer Master Key (CMK) in KMS and link this key by providing the CMK ARN when you create an EKS cluster.,https://docs.aws.amazon.com/eks/latest/userguide/create-cluster.html,Data Protection
N.N,[checkN] Description ,NOT_SCORED,EXTRA,Medium,"AwsAccount"" # Choose appropriate value from https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-findings-format.html#asff-resource",extraN,extraN,NA,"service"" # get service short name from `curl -s https://api.regional-table.region-services.aws.a2z.com/index.json | jq -r '.prices[] | .id' | awk -F: '{ print $1 }' | sort -u",,,,
7.30,[extra730] Check if ACM Certificates are about to expire in $DAYS_TO_EXPIRE_THRESHOLD days or less,NOT_SCORED,EXTRA,High,AwsCertificateManagerCertificate,extra730,extra730,NA,acm,Expired certificates can impact service availability.,Monitor certificate expiration and take automated action to renew; replace or remove. Having shorter TTL for any security artifact is a general recommendation; but requires additional automation in place. If not longer required delete certificate. Use AWS config using the managed rule: acm-certificate-expiration-check.,https://docs.aws.amazon.com/config/latest/developerguide/acm-certificate-expiration-check.html,Data Protection
7.39,[extra739] Check if RDS instances have backup enabled,NOT_SCORED,EXTRA,Medium,AwsRdsDbInstance,extra739,extra739,NA,rds,If backup is not enabled; data is vulnerable. Human error or bad actors could erase or modify data.,Enable automated backup for production data. Define a retention period and periodically test backup restoration. A Disaster Recovery process should be in place to govern Data Protection approach.,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithAutomatedBackups.html,Data Protection
7.151,[extra7151] Check if DynamoDB tables point-in-time recovery (PITR) is enabled,NOT_SCORED,EXTRA,Medium,AwsDynamoDbTable,extra7151,extra7151,NA,dynamodb,If the DynamoDB Table does not have point-in-time recovery enabled; it is vulnerable to accidental write or delete operations.,Enable point-in-time recovery; this is not enabled by default.,https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery_Howitworks.html,Data Protection
1.3,[check13] Ensure credentials unused for 90 days or greater are disabled,SCORED,LEVEL1,Medium,AwsIamUser,check13,check13,ens-op.acc.1.aws.iam.3 ens-op.acc.5.aws.iam.4,iam,AWS IAM users can access AWS resources using different types of credentials (passwords or access keys). It is recommended that all credentials that have been unused in 90 or greater days be removed or deactivated.,Use the credential report to  ensure password_last_changed is less than 90 days ago.,https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_getting-report.html,IAM
7.156,[extra7156] Checks if API Gateway V2 has Access Logging enabled,NOT_SCORED,EXTRA,Medium,AwsApiGatewayV2Api,extra7156,extra7156,NA,apigateway,If not enabled the logging of API calls is not possible. This information is important for monitoring API access.,Enable Access Logging in the API stage.,https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-apigatewayv2-stage-accesslogsettings.html,Logging and Monitoring
7.169,[extra7169] Check if global accelerators are protected by AWS Shield Advanced,NOT_SCORED,EXTRA,Medium,AwsGlobalAccelerator,extra7169,extra7169,NA,shield,AWS Shield Advanced provides expanded DDoS attack protection for your resources,Add as a protected resource in AWS Shield Advanced.,https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html,Infrastructure security
1.4,[check14] Ensure access keys are rotated every 90 days or less,SCORED,LEVEL1,Medium,AwsIamUser,check14,check14,ens-op.acc.1.aws.iam.4 ens-op.acc.5.aws.iam.3,iam,Access keys consist of an access key ID and secret access key which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI)- Tools for Windows PowerShell- the AWS SDKs- or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.,Use the credential report to  ensure  access_key_X_last_rotated  is less than 90 days ago.,https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_getting-report.html,IAM
7.160,[extra7160] Check if Redshift has automatic upgrades enabled,NOT_SCORED,EXTRA,Medium,AwsRedshift,extra7160,extra7160,NA,redshift,Without automatic version upgrade enabled; a critical Redshift Cluster version can become severly out of date.,Enabled AutomaticVersionUpgrade on Redshift Cluster,https://docs.aws.amazon.com/redshift/latest/mgmt/managing-cluster-operations.html,Infrastructure Security
7.194,[extra7194] Check if ECR repositories have lifecycle policies enabled,NOT_SCORED,EXTRA,Low,AwsEcrRepository,extra7194,extra7194,NA,ecr,"Amazon ECR repositories run the risk of retaining huge volumes of images, increasing unnecessary cost.",Open the Amazon ECR console. Create an ECR lifecycle policy.,https://docs.aws.amazon.com/AmazonECR/latest/userguide/LifecyclePolicies.html,
2.2,[check22] Ensure CloudTrail log file validation is enabled,SCORED,LEVEL2,Medium,AwsCloudTrailTrail,check22,check22,ens-op.exp.10.aws.trail.1,cloudtrail,Enabling log file validation will provide additional integrity checking of CloudTrail logs. ,Ensure LogFileValidationEnabled is set to true for each trail.,http://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-log-filevalidation-enabling.html,Logging and Monitoring
7.193,[extra7193] Ensure default Internet Access from your Amazon AppStream fleet streaming instances should remain unchecked.,NOT_SCORED,EXTRA,Medium,AmazonAppStream,extra7193,extra7193,NA,appstream,Default Internet Access from your fleet streaming instances should be controlled using a NAT gateway in the VPC.,Uncheck the default internet access for the AppStream Fleet.,https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html,Infrastructure Security
7.167,[extra7167] Check if Cloudfront distributions are protected by AWS Shield Advanced,NOT_SCORED,EXTRA,Medium,AwsCloudFrontDistribution,extra7167,extra7167,NA,shield,AWS Shield Advanced provides expanded DDoS attack protection for your resources,Add as a protected resource in AWS Shield Advanced.,https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html,Infrastructure security
2.5,[check25] Ensure AWS Config is enabled in all regions,SCORED,LEVEL1,Medium,NA,check25,check25,ens-op.exp.1.aws.cfg.1,configservice,The AWS configuration item history captured by AWS Config enables security analysis; resource change tracking; and compliance auditing.,It is recommended to enable AWS Config be enabled in all regions.,https://aws.amazon.com/blogs/mt/aws-config-best-practices/,Logging and Monitoring
7.158,[extra7158] Check if ELBV2 has listeners underneath,NOT_SCORED,EXTRA,Medium,AwsElbv2LoadBalancer,extra7158,extra7158,NA,elb,The rules that are defined for a listener determine how the load balancer routes requests to its registered targets.,Add listeners to Elastic Load Balancers V2.,https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/elb-listener-config.html,Data Protection
7.133,[extra7133] Check if RDS instances have multi-AZ enabled,NOT_SCORED,EXTRA,Medium,AwsRdsDbInstance,extra7133,extra7133,NA,rds,In case of failure; with a single-AZ deployment configuration; should an availability zone specific database failure occur; Amazon RDS can not automatically fail over to the standby availability zone.,Enable multi-AZ deployment for production databases.,https://aws.amazon.com/rds/features/multi-az/,Data Protection
7.134,[extra7134] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to FTP ports 20 or 21 ,NOT_SCORED,EXTRA,High,AwsEc2SecurityGroup,extra7134,extra7134,NA,ec2,If Security groups are not properly configured the attack surface is increased. ,Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.,https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html,Infrastructure Security
7.102,[extra7102] Check if any of the Elastic or Public IP are in Shodan (requires Shodan API KEY),NOT_SCORED,EXTRA,High,AwsEc2Eip,extra7102,extra7102,NA,ec2,Sites like Shodan index exposed systems and further expose them to wider audiences as a quick way to find exploitable systems.,Check Identified IPs; consider changing them to private ones and delete them from Shodan.,https://www.shodan.io/,Infrastructure Security
7.105,[extra7105] Check if Amazon SageMaker Models have network isolation enabled,NOT_SCORED,EXTRA,Medium,AwsSageMakerModel,extra7105,extra7105,NA,sagemaker,This could provide an avenue for unauthorized access to your data.,Restrict which traffic can access by launching Studio in a Virtual Private Cloud (VPC) of your choosing.,https://docs.aws.amazon.com/sagemaker/latest/dg/studio-notebooks-and-internet-access.html,Infrastructure Security
7.166,[extra7166] Check if Elastic IP addresses with associations are protected by AWS Shield Advanced,NOT_SCORED,EXTRA,Medium,AwsEc2Eip,extra7166,extra7166,NA,shield,AWS Shield Advanced provides expanded DDoS attack protection for your resources,Add as a protected resource in AWS Shield Advanced.,https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html,Infrastructure security
7.192,[extra7192] Ensure session idle disconnect timeout is set to 10 minutes or less.,NOT_SCORED,EXTRA,Medium,AmazonAppStream,extra7192,extra7192,NA,appstream,Idle disconnect timeout in minutes is the amount of time that users can be inactive before they are disconnected from their streaming session and the Disconnect timeout in minutes time begins.,Change the session idle timeout to 10 minutes or less for the AppStream Fleet.,https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html,Infrastructure Security
7.159,[extra7159] Check if ELB has listeners underneath,NOT_SCORED,EXTRA,Medium,AwsElbLoadBalancer,extra7159,extra7159,NA,elb,The rules that are defined for a listener determine how the load balancer routes requests to its registered targets.,Add listeners to Elastic Load Balancers.,https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/elb-listener-config.html,Data Protection
2.4,[check24] Ensure CloudTrail trails are integrated with CloudWatch Logs,SCORED,LEVEL1,Low,AwsCloudTrailTrail,check24,check24,ens-op.exp.8.aws.cw.1,cloudtrail,Sending CloudTrail logs to CloudWatch Logs will facilitate real-time and historic activity logging based on user; API; resource; and IP address; and provides opportunity to establish alarms and notifications for anomalous or sensitivity account activity.,Validate that the trails in CloudTrail has an arn set in the CloudWatchLogsLogGroupArn property.,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html,Logging and Monitoring
7.195,[check7195] Ensure CodeArtifact internal packages do not allow external public source publishing.,NOT_SCORED,EXTRA,Critical,Other,extra7195,extra7195,NA,codeartifact,Allowing package versions of a package to be added both by direct publishing and ingesting from public repositories makes you vulnerable to a dependency substitution attack.,Configure package origin controls on a package in a repository to limit how versions of that package can be added to the repository.,https://docs.aws.amazon.com/codeartifact/latest/ug/package-origin-controls.html,
7.161,[extra7161] Check if EFS protects sensitive data with encryption at rest,NOT_SCORED,EXTRA,Medium,AwsEfsFileSystem,extra7161,extra7161,NA,efs,EFS should be encrypted at rest to prevent exposure of sensitive data to bad actors,Ensure that encryption at rest is enabled for EFS file systems. Encryption at rest can only be enabled during the file system creation.,https://docs.aws.amazon.com/efs/latest/ug/encryption-at-rest.html,Data Protection
2.3,[check23] Ensure the S3 bucket CloudTrail logs to is not publicly accessible,SCORED,LEVEL1,Critical,AwsS3Bucket,check23,check23,ens-op.exp.10.aws.trail.3 ens-op.exp.10.aws.trail.4,cloudtrail,Allowing public access to CloudTrail log content may aid an adversary in identifying weaknesses in the affected accounts use or configuration.,Analyze Bucket policy to validate appropriate permissions. Ensure the AllUsers principal is not granted privileges. Ensure the AuthenticatedUsers principal is not granted privileges.,https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_principal.html,Logging and Monitoring
7.157,[extra7157] Check if API Gateway V2 has configured authorizers,NOT_SCORED,EXTRA,Medium,AwsApiGatewayV2Api,extra7157,extra7157,NA,apigateway,If no authorizer is enabled anyone can use the service.,Implement JWT or Lambda Function to control access to your API.,https://docs.aws.amazon.com/apigatewayv2/latest/api-reference/apis-apiid-authorizers.html,IAM
1.5,[check15] Ensure IAM password policy requires at least one uppercase letter,SCORED,LEVEL1,Medium,NA,check15,check15,NA,iam,Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.,"Ensure ""Requires at least one uppercase letter"" is checked under ""Password Policy"".",https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html,IAM
7.168,[extra7168] Check if Route53 hosted zones are protected by AWS Shield Advanced,NOT_SCORED,EXTRA,Medium,AwsRoute53Domain,extra7168,extra7168,NA,shield,AWS Shield Advanced provides expanded DDoS attack protection for your resources,Add as a protected resource in AWS Shield Advanced.,https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html,Infrastructure security
7.150,[extra7150] Check if Elastic Load Balancers have deletion protection enabled,NOT_SCORED,EXTRA,Medium,AwsElbLoadBalancer,extra7150,extra7150,NA,elb,If deletion protection is not enabled; the resource is not protected against deletion.,Enable deletion protection attribute; this is not enabled by default.,https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancers.html#deletion-protection,Data Protection
1.2,[check12] Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password,SCORED,LEVEL1,High,AwsIamUser,check12,check12,ens-op.acc.5.aws.iam.1,iam,Unauthorized access to this critical account if password is not secure or it is disclosed in any way.,Enable MFA for all IAM users that have a console password. MFA is a simple best practice that adds an extra layer of protection on top of your user name and password. Recommended to use hardware keys over virtual MFA.,https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable_virtual.html,IAM
4.6,[check46] Ensure no Network ACLs allow ingress from 0.0.0.0/0 to Microsoft RDP port 3389,SCORED,LEVEL2,High,AwsEc2NetworkAcl,check46,check46,NA,ec2,Even having a perimeter firewall; having network acls open allows any user or malware with vpc access to scan for well known and sensitive ports and gain access to instance.,Apply Zero Trust approach. Implement a process to scan and remediate unrestricted or overly permissive network acls. Recommended best practices is to narrow the definition for the minimum ports required.,https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html,Infrastructure Security
7.104,[extra7104] Check if Amazon SageMaker Notebook instances have VPC settings configured,NOT_SCORED,EXTRA,Medium,AwsSageMakerNotebookInstance,extra7104,extra7104,NA,sagemaker,This could provide an avenue for unauthorized access to your data.,Restrict which traffic can access by launching Studio in a Virtual Private Cloud (VPC) of your choosing.,https://docs.aws.amazon.com/sagemaker/latest/dg/studio-notebooks-and-internet-access.html,Infrastructure Security
4.1,[check41] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 22,SCORED,LEVEL2,High,AwsEc2SecurityGroup,check41,check41,ens-mp.com.4.aws.sg.4,ec2,Even having a perimeter firewall; having security groups open allows any user or malware with vpc access to scan for well known and sensitive ports and gain access to instance.,Apply Zero Trust approach. Implement a process to scan and remediate unrestricted or overly permissive security groups. Recommended best practices is to narrow the definition for the minimum ports required.,https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html,Infrastructure Security
7.103,[extra7103] Check if Amazon SageMaker Notebook instances have root access disabled,NOT_SCORED,EXTRA,Medium,AwsSageMakerNotebookInstance,extra7103,extra7103,NA,sagemaker,Users with root access have administrator privileges; users can access and edit all files on a notebook instance with root access enabled.,set the RootAccess field to Disabled. You can also disable root access for users when you create or update a notebook instance in the Amazon SageMaker console.,https://docs.aws.amazon.com/sagemaker/latest/dg/nbi-root-access.html,IAM
7.135,[extra7135] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Kafka port 9092 ,NOT_SCORED,EXTRA,High,AwsEc2SecurityGroup,extra7135,extra7135,NA,ec2,If Security groups are not properly configured the attack surface is increased. ,Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.,https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html,Infrastructure Security
7.132,[extra7132] Check if RDS instances has enhanced monitoring enabled,NOT_SCORED,EXTRA,Low,AwsRdsDbInstance,extra7132,extra7132,NA,rds,A smaller monitoring interval results in more frequent reporting of OS metrics.,To use Enhanced Monitoring; you must create an IAM role; and then enable Enhanced Monitoring.,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Monitoring.OS.html,Logging and Monitoring
3.4,[check34] Ensure a log metric filter and alarm exist for IAM policy changes,SCORED,LEVEL1,Medium,AwsCloudTrailTrail,check34,check34,ens-op.exp.8.aws.trail.6,iam,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.,It is recommended that a metric filter and alarm be established for unauthorized requests.,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,IAM
7.149,[extra7149] Check if Redshift Clusters have automated snapshots enabled,NOT_SCORED,EXTRA,Medium,AwsRedshiftCluster,extra7149,extra7149,NA,redshift,If backup is not enabled; data is vulnerable. Human error or bad actors could erase or modify data.,Enable automated backup for production data. Define a retention period and periodically test backup restoration. A Disaster Recovery process should be in place to govern Data Protection approach.,https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_Redshift.html,Data Protection
7.182,[extra7182] Directory Service SNS Notifications,NOT_SCORED,EXTRA,Medium,AwsDirectoryService,extra7182,extra7182,NA,ds,"As a best practice, monitor status of Directory Service. This helps to avoid late actions to fix Directory Service issues",It is recommended set up SNS messaging to send email or text messages when the status of your directory changes,https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_enable_notifications.html,Infrastructure Security
7.176,[extra7176] EMR Cluster without Public IP,NOT_SCORED,EXTRA,Medium,NA,extra7176,extra7176,NA,emr,EMR Cluster should not have Public IP,Only make acceptable EMR clusters public,https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-block-public-access.html,Infrastructure Security
3.3,[check33] Ensure a log metric filter and alarm exist for usage of root account,SCORED,LEVEL1,Medium,AwsCloudTrailTrail,check33,check33,ens-op.exp.8.aws.trail.5,iam,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.,It is recommended that a metric filter and alarm be established for unauthorized requests.,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,Logging and Monitoring
7.171,[extra7171] Check if classic load balancers are protected by AWS Shield Advanced,NOT_SCORED,EXTRA,Medium,AwsElasticLoadBalancingLoadBalancer,extra7171,extra7171,NA,shield,AWS Shield Advanced provides expanded DDoS attack protection for your resources,Add as a protected resource in AWS Shield Advanced.,https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html,Infrastructure security
7.185,[extra7185] Ensure no Customer Managed IAM policies allow actions that may lead into Privilege Escalation,NOT_SCORED,EXTRA,High,AwsIamPolicy,extra7185,extra7185,NA,iam,Users with some IAM permissions are allowed to elevate their privileges up to administrator rights.,Grant usage permission on a per-resource basis and applying least privilege principle.,https://docs.aws.amazon.com/IAM/latest/APIReference/API_CreateAccessKey.html,IAM
7.178,[extra7178] EMR Account Public Access Block enabled,NOT_SCORED,EXTRA,High,NA,extra7178,extra7178,NA,emr,EMR Clusters must have Account Public Access Block enabled,Enable EMR Account Public Access Block,https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-block-public-access.html,Infrastructure Security
7.147,[extra7147] Check if S3 Glacier vaults have policies which allow access to everyone,NOT_SCORED,EXTRA,Critical,AwsGlacierVault,extra7147,extra7147,NA,glacier,Vaults accessible to everyone could expose sensitive data to bad actors,Ensure vault policy does not have principle as *,https://docs.aws.amazon.com/amazonglacier/latest/dev/access-control-overview.html,Data Protection
7.140,[extra7140] Check if there are SSM Documents set as public,NOT_SCORED,EXTRA,High,AwsSsmDocument,extra7140,extra7140,NA,ssm,SSM Documents may contain private information or even secrets and tokens.,Carefully review the contents of the document before is shared. Enable SSM Block public sharing for documents.,https://docs.aws.amazon.com/systems-manager/latest/userguide/ssm-before-you-share.html,Data Protection
7.114,[extra7114] Check if Glue development endpoints have S3 encryption enabled.,NOT_SCORED,EXTRA,Medium,AwsGlue,extra7114,extra7114,NA,glue,Data exfiltration could happen if information is not protected. KMS keys provide additional security level to IAM policies.,Specify AWS KMS keys to use for input and output from S3 and EBS.,https://docs.aws.amazon.com/glue/latest/dg/encryption-security-configuration.html,Data Protection
7.113,[extra7113] Check if RDS instances have deletion protection enabled ,NOT_SCORED,EXTRA,Medium,AwsRdsDbInstance,extra7113,extra7113,NA,rds,You can only delete instances that do not have deletion protection enabled.,Enable deletion protection using the AWS Management Console for production DB instances.,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_DeleteInstance.html,Data Protection
7.125,[extra7125] Check if IAM users have Hardware MFA enabled.,NOT_SCORED,EXTRA,Medium,AwsIamUser,extra7125,extra7125,ens-op.acc.5.aws.iam.2,iam,Hardware MFA is preferred over virtual MFA.,Enable hardware MFA device for an IAM user from the AWS Management Console; the command line; or the IAM API.,https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable_physical.html,IAM
7.122,[extra7122] Check if Glue ETL Jobs have Job bookmark encryption enabled.,NOT_SCORED,EXTRA,Medium,AwsGlue,extra7122,extra7122,NA,glue,If not enabled sensitive information at rest is not protected.,Enable Encryption in the Security configurations.,https://docs.aws.amazon.com/glue/latest/dg/console-security-configurations.html,Data Protection
7.141,[extra7141] Find secrets in SSM Documents,NOT_SCORED,EXTRA,Critical,AwsSsmDocument,extra7141,extra7141,NA,ssm,Secrets hardcoded into SSM Documents by malware and bad actors to gain lateral access to other services.,Implement automated detective control (e.g. using tools like Prowler) to scan accounts for passwords and secrets. Use Secrets Manager service to store and retrieve passwords and secrets.,https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-secretsmanager-secret-generatesecretstring.html,IAM
7.179,[extra7179] Check Public Lambda Function URL,NOT_SCORED,EXTRA,High,AwsLambdaFunction,extra7179,extra7179,NA,lambda,Publicly accessible services could expose sensitive data to bad actors.,Grant usage permission on a per-resource basis and applying least privilege principle.,https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html,Infrastructure Security
7.146,[extra7146] Check if there is any unassigned Elastic IP,NOT_SCORED,EXTRA,Low,AwsElasticIPs,extra7146,extra7146,NA,ec2,Unassigned Elastic IPs may result in extra cost,Ensure Elastic IPs are not unassigned,https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/elastic-ip-addresses-eip.html,Infrastructure Security
3.2,[check32] Ensure a log metric filter and alarm exist for Management Console sign-in without MFA,SCORED,LEVEL1,Medium,AwsCloudTrailTrail,check32,check32,ens-op.exp.8.aws.trail.4,iam,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.,It is recommended that a metric filter and alarm be established for unauthorized requests.,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,Logging and Monitoring
7.184,[extra7184] Directory Service Manual Snapshot Limit,NOT_SCORED,EXTRA,Low,AwsDirectoryService,extra7184,extra7184,NA,ds,A limit reached can bring unwanted results. The maximum number of manual snapshots is a hard limit,Monitor manual snapshots limit to ensure capacity when you need it.,https://docs.aws.amazon.com/general/latest/gr/ds_region.html,Infrastructure Security
7.170,[extra7170] Check if internet-facing application load balancers are protected by AWS Shield Advanced,NOT_SCORED,EXTRA,Medium,AwsElasticLoadBalancingV2LoadBalancer,extra7170,extra7170,NA,shield,AWS Shield Advanced provides expanded DDoS attack protection for your resources,Add as a protected resource in AWS Shield Advanced.,https://docs.aws.amazon.com/waf/latest/developerguide/configure-new-protection.html,Infrastructure security
7.148,[extra7148] Check if EFS File systems have backup enabled,NOT_SCORED,EXTRA,Medium,AwsEfsFileSystem,extra7148,extra7148,NA,efs,If backup is not enabled; data is vulnerable. Human error or bad actors could erase or modify data.,Enable automated backup for production data. Define a retention period and periodically test backup restoration. A Disaster Recovery process should be in place to govern Data Protection approach.,https://docs.aws.amazon.com/efs/latest/ug/whatisefs.html,Data Protection
3.5,[check35] Ensure a log metric filter and alarm exist for CloudTrail configuration changes,SCORED,LEVEL1,Medium,AwsCloudTrailTrail,check35,check35,ens-op.exp.8.aws.trail.1,cloudtrail,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.,It is recommended that a metric filter and alarm be established for unauthorized requests.,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,Logging and Monitoring
7.177,[extra7177] Publicly accessible EMR Cluster,NOT_SCORED,EXTRA,High,NA,extra7177,extra7177,NA,emr,EMR Clusters should not be publicly accessible,Only make acceptable EMR clusters public,https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-block-public-access.html,Infrastructure Security
7.183,[extra7183] Directory Service LDAP Certificates expiration,NOT_SCORED,EXTRA,Medium,AwsDirectoryService,extra7183,extra7183,NA,ds,Expired certificates can impact service availability.,Monitor certificate expiration and take automated action to alarm responsible team for taking care of the replacement or remove.,https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_ldap.html,Data Protection
7.123,[extra7123] Check if IAM users have two active access keys,NOT_SCORED,EXTRA,Medium,AwsIamUser,extra7123,extra7123,ens-op.acc.1.aws.iam.2,iam,Access Keys could be lost or stolen. It creates a critical risk.,Avoid using long lived access keys.,https://docs.aws.amazon.com/IAM/latest/APIReference/API_ListAccessKeys.html,IAM
7.124,[extra7124] Check if EC2 instances are managed by Systems Manager.,NOT_SCORED,EXTRA,Medium,AwsEc2Instance,extra7124,extra7124,ens-op.exp.1.aws.sys.1 ens-op.acc.4.aws.sys.1,ssm,AWS Config provides AWS Managed Rules; which are predefined; customizable rules that AWS Config uses to evaluate whether your AWS resource configurations comply with common best practices.,Verify and apply Systems Manager Prerequisites.,https://docs.aws.amazon.com/systems-manager/latest/userguide/managed_instances.html,Infrastructure Security
7.112,[extra7112] Check if Amazon SageMaker Notebook instances have data encryption enabled,NOT_SCORED,EXTRA,Medium,AwsSageMakerNotebookInstance,extra7112,extra7112,NA,sagemaker,Data exfiltration could happen if information is not protected. KMS keys provide additional security level to IAM policies.,Specify AWS KMS keys to use for input and output from S3 and EBS.,https://docs.aws.amazon.com/sagemaker/latest/dg/key-management.html,Data Protection
7.115,[extra7115] Check if Glue database connection has SSL connection enabled.,NOT_SCORED,EXTRA,Medium,AwsGlue,extra7115,extra7115,NA,glue,Data exfiltration could happen if information is not protected in transit.,Configure encryption settings for crawlers; ETL jobs; and development endpoints using security configurations in AWS Glue.,https://docs.aws.amazon.com/glue/latest/dg/encryption-in-transit.html,Data Protection
7.45,[extra745] Check if API Gateway endpoint is public or private,NOT_SCORED,EXTRA,Medium,AwsApiGatewayRestApi,extra745,extra745,NA,apigateway,If accessible from internet opens up attack / abuse surface for any malicious user.,Make Api Gateway private if a public endpoint is not necessary. Detective controls for common risks should be implemented.,https://d1.awsstatic.com/whitepapers/api-gateway-security.pdf?svrd_sip6,Infrastructure Security
3.11,[check311] Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL),SCORED,LEVEL2,Medium,AwsCloudTrailTrail,check311,check311,NA,vpc,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.,It is recommended that a metric filter and alarm be established for unauthorized requests.,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,Logging and Monitoring
7.89,[extra789] Find trust boundaries in VPC endpoint services connections,NOT_SCORED,EXTRA,Medium,AwsEc2Vpc,extra789,NA,NA,vpc,Account VPC could be linked to other accounts.,In multi Account environments identify untrusted links. Check trust chaining and dependencies between accounts.,https://github.com/toniblyx/prowler/#trust-boundaries-checks,Infrastructure Security
7.42,[extra742] Find secrets in CloudFormation outputs,NOT_SCORED,EXTRA,Critical,AwsCloudFormationStack,extra742,extra742,NA,cloudformation,Secrets hardcoded into CloudFormation outputs can be used by malware and bad actors to gain lateral access to other services.,Implement automated detective control (e.g. using tools like Prowler ) to scan accounts for passwords and secrets. Use secrets manager service to store and retrieve passwords and secrets. ,https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-secretsmanager-secret-generatesecretstring.html,IAM
1.15,[check115] Ensure security questions are registered in the AWS account,NOT_SCORED,LEVEL1,Medium,NA,check115,check115,NA,support,"The AWS support portal allows account owners to establish security questions that can be used to authenticate individuals calling AWS customer service for support. It is recommended that security questions be established. When creating a new AWS account a default super user is automatically created. This account is referred to as the ""root"" account. It is recommended that the use of this account be limited and highly controlled. During events in which the root password is no longer accessible or the MFA token associated with root is lost/destroyed it is possible through authentication using secret questions and associated answers to recover root login access.",Login as root account and from My Account configure Security questions.,https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys_retrieve.html,IAM
7.74,[extra774] Ensure credentials unused for 30 days or greater are disabled,NOT_SCORED,EXTRA,Medium,AwsIamUser,extra774,extra774,NA,iam,To increase the security of your AWS account; remove IAM user credentials (that is; passwords and access keys) that are not needed. For example; when users leave your organization or no longer need AWS access.,Find the credentials that they were using and ensure that they are no longer operational. Ideally; you delete credentials if they are no longer needed. You can always recreate them at a later date if the need arises. At the very least; you should change the password or deactivate the access keys so that the former users no longer have access.,https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_finding-unused.html,IAM
7.80,[extra780] Check if Amazon OpenSearch Service domains (formerly known as Elasticsearch or ES) has either Amazon Cognito authentication or SAML authentication for Kibana enabled,NOT_SCORED,EXTRA,High,AwsElasticsearchDomain,extra780,extra780,NA,es,"Enable Amazon Cognito authentication or SAML authentication for Kibana, supported by Amazon OpenSearch Service (formerly known as Elasticsearch).",If you do not configure Amazon Cognito or SAML authentication; you can still protect Kibana using an IP-based access policy and a proxy server; HTTP basic authentication.,https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-ac.html,IAM
1.12,[check112] Ensure no root account access key exists,SCORED,LEVEL1,Critical,NA,check112,check112,NA,iam,The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed. Removing access keys associated with the root account limits vectors by which the account can be compromised. Removing the root access keys encourages the creation and use of role based accounts that are least privileged.,Use the credential report to  that the user and ensure the access_key_1_active and access_key_2_active fields are set to FALSE .,https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_getting-report.html,IAM
7.87,[extra787] Check connection and authentication for Internet exposed Elasticsearch/Kibana ports,NOT_SCORED,EXTRA,Critical,AwsEc2Instance,extra787,extra787,NA,es,Internet exposed services increases the risk of unauthorised.,Placing an Amazon ES domain within a VPC enables secure communication between Amazon ES and other services within the VPC without the need for an internet gateway; NAT device; or VPN connection. All traffic remains securely within the AWS Cloud.,https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-vpc.html,Infrastructure Security
7.73,[extra773] Check if CloudFront distributions are using WAF ,NOT_SCORED,EXTRA,Medium,AwsCloudFrontDistribution,extra773,extra773,ens-mp.s.2.aws.waf.1,cloudfront,Potential attacks and / or abuse of service; more even for even for internet reachable services.,Use AWS WAF to protect your service from common web exploits. These could affect availability and performance; compromise security; or consume excessive resources.,https://docs.aws.amazon.com/waf/latest/developerguide/cloudfront-features.html,Infrastructure Security
7.27,[extra727] Check if SQS queues have policy set as Public,NOT_SCORED,EXTRA,Critical,AwsSqsQueue,extra727,extra727,NA,sqs,Sensitive information could be disclosed.,Review service with overly permissive policies. Adhere to Principle of Least Privilege.,https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-basic-examples-of-sqs-policies.html,Infrastructure Security
7.2,[extra72] Ensure there are no EBS Snapshots set as Public,NOT_SCORED,EXTRA,Critical,AwsEc2Snapshot,extra72,extra72,NA,ec2,When you share a snapshot; you are giving others access to all of the data on the snapshot. Share snapshots only with people with whom you want to share all of your snapshot data.,Ensure the snapshot should be shared.,https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-modifying-snapshot-permissions.html,Data Protection
7.18,[extra718] Check if S3 buckets have server access logging enabled,NOT_SCORED,EXTRA,Medium,AwsS3Bucket,extra718,extra718,NA,s3,Server access logs can assist you in security and access audits; help you learn about your customer base; and understand your Amazon S3 bill.,Ensure that S3 buckets have Logging enabled. CloudTrail data events can be used in place of S3 bucket logging. If that is the case; this finding can be considered a false positive.,https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html,Logging and Monitoring
7.20,[extra720] Check if Lambda functions invoke API operations are being recorded by CloudTrail,NOT_SCORED,EXTRA,Low,AwsLambdaFunction,extra720,extra720,NA,lambda,If logs are not enabled; monitoring of service use and threat analysis is not possible.,Make sure you are logging information about Lambda operations. Create a lifecycle and use cases for each trail.,https://docs.aws.amazon.com/lambda/latest/dg/logging-using-cloudtrail.html,Logging and Monitoring
7.5,[extra75] Ensure there are no Security Groups not being used,NOT_SCORED,EXTRA,Informational,AwsEc2SecurityGroup,extra75,extra75,ens-mp.com.4.aws.sg.3,ec2,Having clear definition and scope for Security Groups creates a better administration environment.,List all the security groups and then use the cli to check if they are attached to an instance.,https://aws.amazon.com/premiumsupport/knowledge-center/ec2-find-security-group-resources/,Infrastructure Security
7.16,[extra716] Check if Amazon Elasticsearch Service (ES) domains are set as Public or if it has open policy access,NOT_SCORED,EXTRA,Critical,AwsElasticsearchDomain,extra716,extra716,NA,es,Publicly accessible services could expose sensitive data to bad actors.,Use  VPC endpoints for internal services.,https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-vpc.html,Infrastructure Security
7.29,[extra729] Ensure there are no EBS Volumes unencrypted,NOT_SCORED,EXTRA,Medium,AwsEc2Volume,extra729,extra729,ens-mp.info.3.aws.ebs.1,ec2,Data encryption at rest prevents data visibility in the event of its unauthorized access or theft.,Encrypt all EBS volumes and Enable Encryption by default You can configure your AWS account to enforce the encryption of the new EBS volumes and snapshot copies that you create. For example; Amazon EBS encrypts the EBS volumes created when you launch an instance and the snapshots that you copy from an unencrypted snapshot.,https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html,Data Protection
7.11,[extra711] Check for Publicly Accessible Redshift Clusters,NOT_SCORED,EXTRA,High,AwsRedshiftCluster,extra711,extra711,NA,redshift,Publicly accessible services could expose sensitive data to bad actors.,List all shared Redshift clusters and make sure there is a business reason for them.,https://docs.aws.amazon.com/redshift/latest/mgmt/managing-clusters-vpc.html,Data Protection
1.13,[check113] Ensure MFA is enabled for the root account,SCORED,LEVEL1,Critical,NA,check113,check113,NA,iam,"The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled when a user signs in to an AWS website they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. When virtual MFA is used for root accounts it is recommended that the device used is NOT a personal device but rather a dedicated mobile device (tablet or phone) that is managed to be kept charged and secured independent of any individual personal devices. (""non-personal virtual MFA"") This lessens the risks of losing access to the MFA due to device loss / trade-in or if the individual owning the device is no longer employed at the company.",Using IAM console navigate to Dashboard and expand Activate MFA on your root account.,https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html#id_root-user_manage_mfa,IAM
7.72,[extra772] Check if elastic IPs are unused ,NOT_SCORED,EXTRA,Low,AwsEc2Eip,extra772,extra772,NA,ec2,You are charged by the hour for each Elastic IP address that are not attached to an EC2 instance .,If you don’t need an Elastic IP address; you can stop the charges by releasing the IP address.,https://aws.amazon.com/premiumsupport/knowledge-center/elastic-ip-charges/,Infrastructure Security
7.86,[extra786] Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required ,NOT_SCORED,EXTRA,Medium,AwsEc2Instance,extra786,extra786,NA,ec2,Using IMDSv2 will protect from misconfiguration and SSRF vulnerabilities. IMDSv1 will not.,If you don’t need IMDS you can turn it off. Using aws-cli you can force the instance to use only IMDSv2.,https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html#configuring-instance-metadata-options,Infrastructure Security
1.14,[check114] Ensure hardware MFA is enabled for the root account,SCORED,LEVEL2,Critical,NA,check114,check114,NA,iam,The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled when a user signs in to an AWS website they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2 it is recommended that the root account be protected with a hardware MFA.,Using IAM console navigate to Dashboard and expand Activate MFA on your root account.,https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html#id_root-user_manage_mfa,IAM
7.81,[extra781] Check if Amazon Elasticsearch Service (ES) domains has encryption at-rest enabled,NOT_SCORED,EXTRA,Medium,AwsElasticsearchDomain,extra781,extra781,ens-mp.info.3.aws.au.1,es,If not enable unauthorized access to your data could risk increases.,Enable encryption at rest using AWS KMS to store and manage your encryption keys and the Advanced Encryption Standard algorithm with 256-bit keys (AES-256) to perform the encryption.,https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/encryption-at-rest.html,Data Protection
7.75,[extra775] Find secrets in EC2 Auto Scaling Launch Configuration ,NOT_SCORED,EXTRA,Critical,NA,extra775,extra775,NA,autoscaling,The use of a hard-coded password increases the possibility of password guessing.  If hard-coded passwords are used; it is possible that malicious users gain access through the account in question.,Use Secrets Manager to securely provide database credentials to Lambda functions and secure the databases as well as use the credentials to connect and query them without hardcoding the secrets in code or passing them through environmental variables. ,https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html,IAM
7.88,[extra788] Check connection and authentication for Internet exposed Amazon Elasticsearch Service (ES) domains,NOT_SCORED,EXTRA,Critical,AwsElasticsearchDomain,extra788,extra788,NA,es,Internet exposed services increases the risk of unauthorised.,Placing an Amazon ES domain within a VPC enables secure communication between Amazon ES and other services within the VPC without the need for an internet gateway; NAT device; or VPN connection. All traffic remains securely within the AWS Cloud.,https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-vpc.html,Infrastructure Security
3.10,[check310] Ensure a log metric filter and alarm exist for security group changes,SCORED,LEVEL2,Medium,AwsCloudTrailTrail,check310,check310,NA,ec2,Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.,It is recommended that a metric filter and alarm be established for unauthorized requests.,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html,Logging and Monitoring
1.22,"[check122] Ensure IAM policies that allow full \""*:*\"" administrative privileges are not created",SCORED,LEVEL1,Medium,AwsIamPolicy,check122,check122,NA,iam,IAM policies are the means by which privileges are granted to users; groups; or roles. It is recommended and considered a standard security advice to grant least privilege—that is; granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks instead of allowing full administrative privileges. Providing full administrative privileges instead of restricting to the minimum set of permissions that the user is required to do exposes the resources to potentially unwanted actions.,It is more secure to start with a minimum set of permissions and grant additional permissions as necessary; rather than starting with permissions that are too lenient and then trying to tighten them later. List policies an analyze if permissions are the least possible to conduct business activities.,http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html,IAM
7.43,[extra743] Check if API Gateway has client certificate enabled to access your backend endpoint,NOT_SCORED,EXTRA,Medium,AwsApiGatewayRestApi,extra743,extra743,NA,apigateway,Possible man in the middle attacks and other similar risks.,Enable client certificate. Mutual TLS is recommended and commonly used for business-to-business (B2B) applications. It’s used in standards such as Open Banking. API Gateway now provides integrated mutual TLS authentication at no additional cost.,https://aws.amazon.com/blogs/compute/introducing-mutual-tls-authentication-for-amazon-api-gateway/,Data Protection
7.44,[extra744] Check if API Gateway has a WAF ACL attached,NOT_SCORED,EXTRA,Medium,AwsApiGatewayRestApi,extra744,extra744,ens-mp.s.2.aws.waf.2,apigateway,Potential attacks and / or abuse of service; more even for even for internet reachable services.,Use AWS WAF to protect your API Gateway API from common web exploits; such as SQL injection and cross-site scripting (XSS) attacks. These could affect API availability and performance; compromise security; or consume excessive resources.,https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-control-access-aws-waf.html,Infrastructure Security
7.10,[extra710] Check for internet facing EC2 Instances,NOT_SCORED,EXTRA,Medium,AwsEc2Instance,extra710,extra710,ens-mp.com.4.aws.vpc.1,ec2,Exposing an EC2 directly to internet increases the attack surface and therefore the risk of compromise.,Use an ALB and apply WAF ACL.,https://aws.amazon.com/blogs/aws/aws-web-application-firewall-waf-for-application-load-balancers/,Infrastructure Security
7.17,[extra717] Check if Elastic Load Balancers have logging enabled,NOT_SCORED,EXTRA,Medium,AwsElbLoadBalancer,extra717,extra717,NA,elb,If logs are not enabled monitoring of service use and threat analysis is not possible.,Enable ELB logging; create la log lifecycle and define use cases.,https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-access-logs.html,Logging and Monitoring
7.28,[extra728] Check if SQS queues have Server Side Encryption enabled,NOT_SCORED,EXTRA,Medium,AwsSqsQueue,extra728,extra728,ens-mp.info.3.sns.1,sqs,If not enabled sensitive information in transit is not protected.,Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits.,https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-configure-sse-existing-queue.html,Data Protection
7.21,[extra721] Check if Redshift cluster has audit logging enabled,NOT_SCORED,EXTRA,Medium,AwsRedshiftCluster,extra721,extra721,NA,redshift,If logs are not enabled; monitoring of service use and threat analysis is not possible.,Enable logs. Create an S3 lifecycle policy. Define use cases; metrics and automated responses where applicable.,https://docs.aws.amazon.com/redshift/latest/mgmt/db-auditing.html,Logging and Monitoring
7.4,[extra74] Ensure there are no Security Groups without ingress filtering being used,NOT_SCORED,EXTRA,High,AwsEc2SecurityGroup,extra74,extra74,ens-mp.com.4.aws.sg.2,ec2,If Security groups are not filtering traffic appropriately the attack surface is increased., You can grant access to a specific CIDR range; or to another security group in your VPC or in a peer VPC.,https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html,Infrastructure Security
7.26,[extra726] Check Trusted Advisor for errors and warnings,NOT_SCORED,EXTRA,Medium,NA,extra726,extra726,NA,trustedadvisor,Improve the security of your application by closing gaps; enabling various AWS security features; and examining your permissions.,Review and act upon its recommendations.,https://aws.amazon.com/premiumsupport/technology/trusted-advisor/best-practice-checklist/,IAM
7.19,[extra719] Check if Route53 public hosted zones are logging queries to CloudWatch Logs,NOT_SCORED,EXTRA,Medium,AwsRoute53HostedZone,extra719,extra719,NA,route53,If logs are not enabled; monitoring of service use and threat analysis is not possible.,Enable CloudWatch logs and define metrics and uses cases for the events recorded.,https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/monitoring-hosted-zones-with-cloudwatch.html,Logging and Monitoring
7.3,[extra73] Ensure there are no S3 buckets open to Everyone or Any AWS user,NOT_SCORED,EXTRA,Critical,AwsS3Bucket,extra73,extra73,NA,s3,Even if you enable all possible bucket ACL options available in the Amazon S3 console the ACL alone does not allow everyone to download objects from your bucket. Depending on which option you select any user could perform some actions.,You can enable block public access settings only for access points; buckets; and AWS accounts. Amazon S3 does not support block public access settings on a per-object basis. When you apply block public access settings to an account; the settings apply to all AWS Regions globally. The settings might not take effect in all Regions immediately or simultaneously; but they eventually propagate to all Regions.,https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html,Data Protection
7.35,[extra735] Check if RDS instances storage is encrypted,NOT_SCORED,EXTRA,Medium,AwsRdsDbInstance,extra735,extra735,ens-mp.info.3.aws.rds.1,rds,If not enabled sensitive information at rest is not protected.,Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits.,https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html,Data Protection
7.32,[extra732] Check if Geo restrictions are enabled in CloudFront distributions,NOT_SCORED,EXTRA,Low,AwsCloudFrontDistribution,extra732,extra732,NA,cloudfront,Consider countries where service should not be accessed; by legal or compliance requirements. Additionally if not restricted the attack vector is increased.,If possible; define and enable Geo restrictions for this service.,https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/georestrictions.html,Infrastructure Security
7.92,[extra792] Check if Elastic Load Balancers have insecure SSL ciphers ,NOT_SCORED,EXTRA,Medium,AwsElbLoadBalancer,extra792,extra792,ens-mp.com.2.aws.elb.2,elb,Using insecure ciphers could affect privacy of in transit information.,Use a Security policy with a ciphers that are stronger as possible. Drop legacy and unsecure ciphers.,https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/elb-ssl-security-policy.html,Data Protection
7.59,[extra759] Find secrets in Lambda functions variables ,NOT_SCORED,EXTRA,Critical,AwsLambdaFunction,extra759,extra759,NA,lambda,The use of a hard-coded password increases the possibility of password guessing.  If hard-coded passwords are used; it is possible that malicious users gain access through the account in question.,Use Secrets Manager to securely provide database credentials to Lambda functions and secure the databases as well as use the credentials to connect and query them without hardcoding the secrets in code or passing them through environmental variables. ,https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html,IAM
7.95,[extra795] Ensure EKS Clusters are created with Private Endpoint Enabled and Public Access Disabled,NOT_SCORED,EXTRA,High,AwsEksCluster,extra795,extra795,NA,eks,Publicly accessible services could expose sensitive data to bad actors.,Enable private access to the Kubernetes API server so that all communication between your nodes and the API server stays within your VPC. Disable internet access to the API server.,https://docs.aws.amazon.com/eks/latest/userguide/infrastructure-security.html,Infrastructure Security
7.61,[extra761] Check if EBS Default Encryption is activated ,NOT_SCORED,EXTRA,Medium,NA,extra761,extra761,ens-mp.info.3.aws.ebs.2,ec2,If not enabled sensitive information at rest is not protected.,Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits.,https://aws.amazon.com/premiumsupport/knowledge-center/ebs-automatic-encryption/,Data Protection
7.57,[extra757] Check EC2 Instances older than 6 months,NOT_SCORED,EXTRA,Medium,AwsEc2Instance,extra757,extra757,NA,ec2,Having old instances within your AWS account could increase the risk of having vulnerable software.,Check if software running in the instance is up to date and patched accordingly. Use AWS Systems Manager to patch instances and view patching compliance information.,https://docs.aws.amazon.com/systems-manager/latest/userguide/viewing-patch-compliance-results.html,Infrastructure Security
7.68,[extra768] Find secrets in ECS task definitions environment variables ,NOT_SCORED,EXTRA,Critical,AwsEcsTaskDefinition,extra768,extra768,NA,ecs,The use of a hard-coded password increases the possibility of password guessing. If hard-coded passwords are used; it is possible that malicious users gain access through the account in question.,Use Secrets Manager or Parameter Store to securely provide credentials to containers without hardcoding the secrets in code or passing them through environment variables.,https://docs.aws.amazon.com/AmazonECS/latest/developerguide/specifying-sensitive-data.html,Logging and Monitoring
7.50,[extra750] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MySQL port 3306,NOT_SCORED,EXTRA,High,AwsEc2SecurityGroup,extra750,extra750,ens-mp.com.4.aws.sg.7,ec2,If Security groups are not properly configured the attack surface is increased. ,Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.,https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html,Infrastructure Security
7.33,[extra733] Check if there are SAML Providers then STS can be used,NOT_SCORED,EXTRA,Low,NA,extra733,extra733,ens-op.acc.1.aws.iam.1,iam,Without SAML provider users with AWS CLI or AWS API access can use IAM static credentials. SAML helps users to assume role by default each time they authenticate.,Enable SAML provider and use temporary credentials. You can use temporary security credentials to make programmatic requests for AWS resources using the AWS CLI or AWS API (using the AWS SDKs ). The temporary credentials provide the same permissions that you have with use long-term security credentials such as IAM user credentials. In case of not having SAML provider capabilities prevent usage of long-lived credentials.,https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithSAML.html,IAM
7.34,[extra734] Check if S3 buckets have default encryption (SSE) enabled or use a bucket policy to enforce it,NOT_SCORED,EXTRA,Medium,AwsS3Bucket,extra734,extra734,ens-mp.info.3.s3.1,s3,Amazon S3 default encryption provides a way to set the default encryption behavior for an S3 bucket. This will ensure data-at-rest is encrypted.,Ensure that S3 buckets has encryption at rest enabled.,https://docs.aws.amazon.com/AmazonS3/latest/dev/bucket-encryption.html,Data Protection
NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,"https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html',Infrastructure Securit",NA
7.51,[extra751] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Postgres port 5432,NOT_SCORED,EXTRA,High,AwsEc2SecurityGroup,extra751,extra751,ens-mp.com.4.aws.sg.8,ec2,If Security groups are not properly configured the attack surface is increased. ,Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.,https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html,Infrastructure Security
7.69,[extra769] Check if IAM Access Analyzer is enabled and its findings ,NOT_SCORED,EXTRA,High,NA,extra769,extra769,NA,accessanalyzer,AWS IAM Access Analyzer helps you identify the resources in your organization and accounts; such as Amazon S3 buckets or IAM roles; that are shared with an external entity. This lets you identify unintended access to your resources and data; which is a security risk. IAM Access Analyzer uses a form of mathematical analysis called automated reasoning; which applies logic and mathematical inference to determine all possible access paths allowed by a resource policy.,Enable IAM Access Analyzer for all accounts; create analyzer and take action over it is recommendations (IAM Access Analyzer is available at no additional cost).,https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html,IAM
7.60,[extra760] Find secrets in Lambda functions code ,NOT_SCORED,EXTRA,Critical,AwsLambdaFunction,extra760,extra760,NA,lambda,The use of a hard-coded password increases the possibility of password guessing.  If hard-coded passwords are used; it is possible that malicious users gain access through the account in question.,Use Secrets Manager to securely provide database credentials to Lambda functions and secure the databases as well as use the credentials to connect and query them without hardcoding the secrets in code or passing them through environmental variables. ,https://docs.aws.amazon.com/secretsmanager/latest/userguide/lambda-functions.html,IAM
7.94,[extra794] Ensure EKS Control Plane Audit Logging is enabled for all log types,NOT_SCORED,EXTRA,Medium,AwsEksCluster,extra794,extra794,NA,eks,If logs are not enabled; monitoring of service use and threat analysis is not possible.,Make sure you logging for EKS control plane is enabled.,https://docs.aws.amazon.com/eks/latest/userguide/logging-monitoring.html,Logging and Monitoring
7.93,[extra793] Check if Elastic Load Balancers have SSL listeners ,NOT_SCORED,EXTRA,Medium,AwsElbLoadBalancer,extra793,extra793,ens-mp.com.2.aws.elb.1,elb,Clear text communication could affect privacy of information in transit.,Scan for Load Balancers with HTTP or TCP listeners and understand the reason for each of them. Check if the listener can be implemented as TLS instead.,https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-https-listener.html,Data Protection
7.67,[extra767] Check if CloudFront distributions have Field Level Encryption enabled ,NOT_SCORED,EXTRA,Low,AwsCloudFrontDistribution,extra767,extra767,NA,cloudfront,Allows you protect specific data throughout system processing so that only certain applications can see it.,Check if applicable to any sensitive data. This encryption ensures that only applications that need the data—and have the credentials to decrypt it - are able to do so.,https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/field-level-encryption.html,Data Protection
7.58,[extra758] Check EC2 Instances older than 12 months ,NOT_SCORED,EXTRA,Medium,AwsEc2Instance,extra758,extra758,NA,ec2,Having old instances within your AWS account could increase the risk of having vulnerable software.,Check if software running in the instance is up to date and patched accordingly. Use AWS Systems Manager to patch instances and view patching compliance information.,https://docs.aws.amazon.com/systems-manager/latest/userguide/viewing-patch-compliance-results.html,Infrastructure Security
7.108,[extra7108] Check if Amazon SageMaker Training jobs have volume and output with KMS encryption enabled,NOT_SCORED,EXTRA,Medium,AwsSageMakerNotebookInstance,extra7108,extra7108,NA,sagemaker,Data exfiltration could happen if information is not protected. KMS keys provide additional security level to IAM policies.,Specify AWS KMS keys to use for input and output from S3 and EBS.,https://docs.aws.amazon.com/sagemaker/latest/dg/key-management.html,Data Protection
7.137,[extra7137] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Windows SQL Server ports 1433 or 1434,NOT_SCORED,EXTRA,High,AwsEc2SecurityGroup,extra7137,extra7137,NA,ec2,If Security groups are not properly configured the attack surface is increased. ,Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.,https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html,Infrastructure Security
7.130,[extra7130] Ensure there are no SNS Topics unencrypted,NOT_SCORED,EXTRA,Medium,AwsSnsTopic,extra7130,extra7130,NA,sns,If not enabled sensitive information at rest is not protected.,Use Amazon SNS with AWS KMS.,https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html,Data Protection
4.4,"[check44] Ensure routing tables for VPC peering are \""least access\""",NOT_SCORED,LEVEL2,Medium,AwsEc2Vpc,check44,check44,NA,vpc,Being highly selective in peering routing tables is a very effective way of minimizing the impact of breach as resources outside of these routes are inaccessible to the peered VPC.,Review routing tables of peered VPCs for whether they route all subnets of each VPC and whether that is necessary to accomplish the intended purposes for peering the VPCs.,https://docs.aws.amazon.com/vpc/latest/peering/peering-configurations-partial-access.html,Infrastructure Security
7.139,[extra7139] There are High severity GuardDuty findings ,NOT_SCORED,EXTRA,High,AwsGuardDutyDetector,extra7139,extra7139,NA,guardduty,If critical findings are not addressed threats can spread in the environment.,Review and remediate critical GuardDuty findings as quickly as possible.,https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_findings.html,Incident Response
7.106,[extra7106] Check if Amazon SageMaker Models have VPC settings configured,NOT_SCORED,EXTRA,Medium,AwsSageMakerModel,extra7106,extra7106,NA,sagemaker,This could provide an avenue for unauthorized access to your data.,Restrict which traffic can access by launching Studio in a Virtual Private Cloud (VPC) of your choosing.,https://docs.aws.amazon.com/sagemaker/latest/dg/studio-notebooks-and-internet-access.html,Infrastructure Security
4.3,[check43] Ensure the default security group of every VPC restricts all traffic,SCORED,LEVEL2,High,AwsEc2SecurityGroup,check43,check43,ens-mp.com.4.aws.sg.1,ec2,Even having a perimeter firewall; having security groups open allows any user or malware with vpc access to scan for well known and sensitive ports and gain access to instance.,Apply Zero Trust approach. Implement a process to scan and remediate unrestricted or overly permissive security groups. Recommended best practices is to narrow the definition for the minimum ports required.,https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html,Infrastructure Security
7.101,[extra7101] Check if Amazon Elasticsearch Service (ES) domains have audit logging enabled,NOT_SCORED,EXTRA,Low,AwsElasticsearchDomain,extra7101,extra7101,NA,es,If logs are not enabled; monitoring of service use and threat analysis is not possible.,Make sure you are logging information about Amazon Elasticsearch Service operations.,https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/audit-logs.html,Logging and Monitoring
7.155,[extra7155] Check whether the Application Load Balancer is configured with defensive or strictest desync mitigation mode,NOT_SCORED,EXTRA,Medium,AwsElasticLoadBalancingV2LoadBalancer,extra7155,extra7155,NA,elb,HTTP Desync issues can lead to request smuggling and make your applications vulnerable to request queue or cache poisoning; which could lead to credential hijacking or execution of unauthorized commands.,Ensure Application Load Balancer is configured with defensive or strictest desync mitigation mode,https://aws.amazon.com/about-aws/whats-new/2020/08/application-and-classic-load-balancers-adding-defense-in-depth-with-introduction-of-desync-mitigation-mode/,Data Protection
2.8,[check28] Ensure rotation for customer created KMS CMKs is enabled,SCORED,LEVEL2,Medium,AwsKmsKey,check28,check28,NA,kms,Cryptographic best practices discourage extensive reuse of encryption keys. Consequently; Customer Master Keys (CMKs) should be rotated to prevent usage of compromised keys.,For every KMS Customer Master Keys (CMKs); ensure that Rotate this key every year is enabled.,https://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html,Data Protection
1.7,[check17] Ensure IAM password policy require at least one symbol,SCORED,LEVEL1,Medium,NA,check17,check17,NA,iam,Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.,"Ensure ""Require at least one non-alphanumeric character"" is checked under ""Password Policy"".",https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html,IAM
7.152,[extra7152] Enable Privacy Protection for for a Route53 Domain (us-east-1 only),NOT_SCORED,EXTRA,Medium,AwsRoute53Domain,extra7152,extra7152,NA,route53,Without privacy protection enabled; ones personal information is published to the public WHOIS database,Ensure default Privacy is enabled,https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/domain-privacy-protection.html,Data Protection
1.9,[check19] Ensure IAM password policy requires minimum length of 14 or greater,SCORED,LEVEL1,Medium,NA,check19,check19,NA,iam,Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.,"Ensure ""Minimum password length"" is set to 14 or greater.",https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html,IAM
7.190,[extra7190] Ensure user maximum session duration is no longer than 10 hours.,NOT_SCORED,EXTRA,Medium,AmazonAppStream,extra7190,extra7190,NA,appstream,Having a session duration lasting longer than 10 hours should not be necessary and if running for any malicious reasons provides a greater time for usage than should be allowed.,Change the Maximum session duration is set to 600 minutes or less for the AppStream Fleet,https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html,Infrastructure Security
7.164,[extra7164] Check if CloudWatch log groups are protected by AWS KMS ,NOT_SCORED,EXTRA,Medium,Logs,extra7164,NA,NA,logs,Using customer managed KMS to encrypt CloudWatch log group provide additional confidentiality and control over the log data,Associate KMS Key with Cloudwatch log group.,https://docs.aws.amazon.com/cli/latest/reference/logs/associate-kms-key.html,Data Protection
2.6,[check26] Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket,SCORED,LEVEL1,Medium,AwsS3Bucket,check26,check26,NA,s3,Server access logs can assist you in security and access audits; help you learn about your customer base; and understand your Amazon S3 bill.,Ensure that S3 buckets have Logging enabled. CloudTrail data events can be used in place of S3 bucket logging. If that is the case; this finding can be considered a false positive.,https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html,Logging and Monitoring
7.163,[extra7163] Check if Secrets Manager key rotation is enabled,NOT_SCORED,EXTRA,Medium,AwsSecretsManagerSecret,extra7163,NA,NA,secretsmanager,Rotating secrets minimizes exposure to attacks using stolen keys.,Enable key rotation on Secrets Manager key.,https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets_strategies.html,Data Protection
2.1,[check21] Ensure CloudTrail is enabled in all regions,SCORED,LEVEL1,High,AwsCloudTrailTrail,check21,check21,ens-op.acc.7.aws.iam.1 ens-op.mon.1.aws.trail.1,cloudtrail,AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller; the time of the API call; the source IP address of the API caller; the request parameters; and the response elements returned by the AWS service.,Ensure Logging is set to ON on all regions (even if they are not being used at the moment.,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrailconcepts.html#cloudtrail-concepts-management-events,Logging and Monitoring
4.2,[check42] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 3389,SCORED,LEVEL2,High,AwsEc2SecurityGroup,check42,check42,ens-mp.com.4.aws.sg.5,ec2,Even having a perimeter firewall; having security groups open allows any user or malware with vpc access to scan for well known and sensitive ports and gain access to instance.,Apply Zero Trust approach. Implement a process to scan and remediate unrestricted or overly permissive security groups. Recommended best practices is to narrow the definition for the minimum ports required.,https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html,Infrastructure Security
NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA
7.100,[extra7100] Ensure that no custom IAM policies exist which allow permissive role assumption (e.g. sts:AssumeRole on *),NOT_SCORED,EXTRA,Critical,AwsIamPolicy,extra7100,extra7100,ens-op.acc.2.aws.iam.1,iam,If not restricted unintended access could happen.,Use the least privilege principle when granting permissions.,https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole.html,IAM
7.138,[extra7138] Ensure no Network ACLs allow ingress from 0.0.0.0/0 to any port,NOT SCORED,LEVEL2,High,AwsEc2NetworkAcl,extra7138,extra7138,NA,ec2,Even having a perimeter firewall; having network acls open allows any user or malware with vpc access to scan for well known and sensitive ports and gain access to instance.,Apply Zero Trust approach. Implement a process to scan and remediate unrestricted or overly permissive network acls. Recommended best practices is to narrow the definition for the minimum ports required.,https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html,Infrastructure Security
4.5,[check45] Ensure no Network ACLs allow ingress from 0.0.0.0/0 to SSH port 22,SCORED,LEVEL2,High,AwsEc2NetworkAcl,check45,check45,NA,ec2,Even having a perimeter firewall; having network acls open allows any user or malware with vpc access to scan for well known and sensitive ports and gain access to instance.,Apply Zero Trust approach. Implement a process to scan and remediate unrestricted or overly permissive network acls. Recommended best practices is to narrow the definition for the minimum ports required.,https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html,Infrastructure Security
7.107,[extra7107] Check if Amazon SageMaker Training jobs have intercontainer encryption enabled,NOT_SCORED,EXTRA,Medium,AwsSageMakerNotebookInstance,extra7107,extra7107,NA,sagemaker,If not restricted unintended access could happen.,Internetwork communications support TLS 1.2 encryption between all components and clients.,https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html,Data Protection
7.131,[extra7131] Ensure RDS instances have minor version upgrade enabled,NOT_SCORED,EXTRA,Low,AwsRdsDbInstance,extra7131,extra7131,NA,rds,Auto Minor Version Upgrade is a feature that you can enable to have your database automatically upgraded when a new minor database engine version is available. Minor version upgrades often patch security vulnerabilities and fix bugs; and therefor should be applied.,Enable auto minor version upgrade for all databases and environments.,https://aws.amazon.com/blogs/database/best-practices-for-upgrading-amazon-rds-to-major-and-minor-versions-of-postgresql/,Infrastructure Security
7.109,[extra7109] Check if Amazon SageMaker Training jobs have network isolation enabled,NOT_SCORED,EXTRA,Medium,AwsSageMakerNotebookInstance,extra7109,extra7109,NA,sagemaker,This could provide an avenue for unauthorized access to your data.,Restrict which traffic can access by launching Studio in a Virtual Private Cloud (VPC) of your choosing.,https://docs.aws.amazon.com/sagemaker/latest/dg/interface-vpc-endpoint.html,Infrastructure Security
7.136,[extra7136] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Telnet port 23,NOT_SCORED,EXTRA,High,AwsEc2SecurityGroup,extra7136,extra7136,NA,ec2,If Security groups are not properly configured the attack surface is increased. ,Use a Zero Trust approach. Narrow ingress traffic as much as possible. Consider north-south as well as east-west traffic.,https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html,Infrastructure Security
7.162,[extra7162] Check if CloudWatch Log Groups have a retention policy of at least 365 days,NOT_SCORED,EXTRA,Medium,AwsLogsLogGroup,extra7162,extra7162,NA,cloudwatch,If log groups have a low retention policy of less than 365 days; crucial logs and data can be lost,Add Log Retention policy of at least 365 days to log groups. This will persist logs and traces for a long time.,https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_Logs.html,Data Retention
7.165,[extra7165] Check if DynamoDB: DAX Clusters are encrypted at rest,NOT_SCORED,EXTRA,Medium,AwsDaxCluster,extra7165,extra7165,NA,dynamodb,Encryption at rest provides an additional layer of data protection by securing your data from unauthorized access to the underlying storage.,Re-create the cluster to enable encryption at rest if it was not enabled at creation.,https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DAXEncryptionAtRest.html,Data Protection
7.191,[extra7191] Ensure session disconnect timeout is set to 5 minutes or less.,NOT_SCORED,EXTRA,Medium,AmazonAppStream,extra7191,extra7191,NA,appstream,"Disconnect timeout in minutes, is the amount of of time that a streaming session remains active after users disconnect.",Change the Disconnect timeout to 5 minutes or less for the AppStream Fleet,https://docs.aws.amazon.com/appstream2/latest/developerguide/set-up-stacks-fleets.html,Infrastructure Security
1.8,[check18] Ensure IAM password policy require at least one number,SCORED,LEVEL1,Medium,NA,check18,check18,NA,iam,Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.,"Ensure ""Require at least one number "" is checked under ""Password Policy"".",https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html,IAM
2.7,[check27] Ensure CloudTrail logs are encrypted at rest using KMS CMKs,SCORED,LEVEL2,Medium,AwsCloudTrailTrail,check27,check27,ens-op.exp.10.aws.trail.5,cloudtrail,By default; the log files delivered by CloudTrail to your bucket are encrypted by Amazon server-side encryption with Amazon S3-managed encryption keys (SSE-S3). To provide a security layer that is directly manageable; you can instead use server-side encryption with AWS KMS–managed keys (SSE-KMS) for your CloudTrail log files.,This approach has the following advantages: You can create and manage the CMK encryption keys yourself. You can use a single CMK to encrypt and decrypt log files for multiple accounts across all regions. You have control over who can use your key for encrypting and decrypting CloudTrail log files. You can assign permissions for the key to the users. You have enhanced security.,https://docs.aws.amazon.com/awscloudtrail/latest/userguide/encrypting-cloudtrail-log-files-with-aws-kms.html,Logging and Monitoring
7.153,[extra7153] Enable Transfer Lock for a Route53 Domain (us-east-1 only),NOT_SCORED,EXTRA,Medium,AwsRoute53Domain,extra7153,extra7153,NA,route53,Without transfer lock enabled; a domain name could be incorrectly moved to a new registrar,Ensure transfer lock is enabled,https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/domain-lock.html,Data Protection
1.1,[check11] Avoid the use of the root account,SCORED,LEVEL1,High,NA,check11,check11,NA,iam,"The ""root"" account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.",Follow the remediation instructions of the Ensure IAM policies are attached only to groups or roles recommendation.,http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html,IAM
2.9,[check29] Ensure VPC Flow Logging is Enabled in all VPCs,SCORED,LEVEL2,Medium,AwsEc2Vpc,check29,check29,ens-op.mon.1.aws.flow.1,vpc,VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.,"It is recommended that VPC Flow Logs be enabled for packet ""Rejects"" for VPCs. ",http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/flow-logs.html ,Logging and Monitoring
7.154,[extra7154] Enable termination protection for Cloudformation Stacks,NOT_SCORED,EXTRA,Medium,AwsCloudFormationStack,extra7154,extra7154,NA,cloudformation,Without termination protection enabled; a critical cloudformation stack can be accidently deleted.,Ensure termination protection is enabled for the cloudformation stacks,https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-protect-stacks.html,Infrastructure Protection
1.6,[check16] Ensure IAM password policy require at least one lowercase letter,SCORED,LEVEL1,Medium,NA,check16,check16,NA,iam,Password policies are used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.,"Ensure ""Requires at least one lowercase letter"" is checked under ""Password Policy"".",https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html,IAM
